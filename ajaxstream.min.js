!function(e,a,t,i,n){function o(e){var a=e.data("ajaxstreamid");return a||0===a?ZZ.streams[a+"_"+e[0].id]:e}function l(e,a,t,i,o){var l=1*e,s=1*a;return o&&(t=t>o.width?o.width:t,i=i>o.height?o.height:i),l>s?l>t&&(s=r(s*=t/l),l=t):s>i&&(l=r(l*=i/s),s=i),{width:n.round(l),height:n.round(s)}}function r(e){return n.round(e)}function s(a){var t=a.x2-a.x;e("#AJSCropT").css({width:t,height:a.y,left:a.x,top:0}),e("#AJSCropR").css({width:a.trackWidth-a.x2,height:a.trackHeight,right:0,top:0}),e("#AJSCropB").css({width:t,height:a.trackHeight-a.y2,left:a.x,bottom:0}),e("#AJSCropL").css({width:a.x,height:a.trackHeight,left:0,top:0})}function d(){if(!k(e("#AJSLegacy"))){var a={method:"post",enctype:"multipart/form-data",target:"AJSIFrame",name:"AJSLegacyForm",action:"/upload.php"};e("body").append(W.getHtml("form",W.getInput("AJSLegacy",null,null,"hidden")+W.getInput(null,"submit",null,"submit"),"AJSLegacyForm",P,a)+W.getHtml("iframe",null,"AJSIFrame",P,{name:"AJSIFrame"}))}}function c(e){var a,t,i,o,l,r,s,d=1e-15,c=e;for(s=n.floor(c),t=1,l=0,a=s,o=1;c-s>d*o*o;)c=1/(c-s),s=n.floor(c),i=t,t=a,r=l,l=o,a=i+s*t,o=r+s*l;return a+":"+o}function u(e){var a=p()+A();return W.getDiv(null,"AJSMainOverlay")+W.getDiv(a+W.getHtml("img",null,"AJSLoading",P,{src:e+"/files/loader.gif",title:C("Files are loading")}),"AJSMain")}function p(){var e=h()+W.getDiv(W.getSpan(null,"AJSL","AJSLR asicons-arrow-left")+W.getSpan(null,"AJSR","AJSLR asicons-arrow-right"),"AJSLRContainer");return W.getDiv(e,"AJSImagePreview",P)}function h(){return W.getDiv(W.getDiv(null,"AJSActionsOverlay")+W.getDiv((B?W.getSpan(null,"AJSAdd","asicons-plus",{title:C("Add another file")}):"")+(B?W.getSpan(null,"AJSChange","asicons-docs",{title:C("Change file")}):"")+(M?W.getSpan(null,"AJSEdit","asicons-pencil",{title:C("Edit")}):"")+W.getSpan(null,"AJSRemove","asicons-trash",{title:C("Remove file")})+W.getSpan(null,"AJSClose","asicons-checkmark",{title:C("Close window")})),"AJSPreviewActions")}function g(){var e="";return e+=W.getDiv(W.getDiv(W.getDiv(W.getHtml("img",null,"AJSResImg")+W.getDiv(W.getDiv(null,"AJSCropT")+W.getDiv(null,"AJSCropR")+W.getDiv(null,"AJSCropB")+W.getDiv(null,"AJSCropL"),"AJSRBG")+W.getDiv(W.getDiv(),"AJSRITrack"),"AJSRInner")+W.getDiv(W.getDiv(W.getDiv(W.getHtml("img",null,"AJSRCImg")),"AJSRCVp"),"AJSRC",P)+W.getDiv(m()+v(),"AJSScaleInfo"),"AJSRIHolder"),"AJSInfo"),W.getDiv(e+W.getDiv(W.getSpan(null,"AJSISave","asicons-checkmark")+W.getSpan(null,"AJSICancel","asicons-cross"),"AJSIBtns"),"AJSMore",P)}function m(){return W.getDiv(W.getSpan(null,null,"AJSEIcon asicons-transform",{"data-for":"AJSWHAR",title:C("Crop Image")})+W.getSpan(null,null,"AJSEIcon asicons-flip-to-front",{"data-for":"AJSRCan",title:C("Resize canvas")}),"AJSEditIcons")}function v(){return S()+f()}function f(){return W.getDiv(W.getDiv(W.getSpan(C("CANVAS WIDTH"))+W.getInput("AJSCW"),null,"AJSSInfo")+W.getDiv(W.getSpan(C("CANVAS HEIGHT"))+W.getInput("AJSCH"),null,"AJSSInfo")+W.getDiv(W.getSpan(C("ZOOM"))+W.getDiv(W.getDiv(),"AJSCZ"),null,"AJSSInfo"),"AJSRCan","AJSEDivs AJSHidden")}function S(){return W.getDiv(W.getDiv(W.getSpan(C("WIDTH"))+W.getInput("AJSSW",null,null,"text",{readonly:""}),null,"AJSSInfo")+W.getDiv(W.getSpan(C("HEIGHT"))+W.getInput("AJSSH",null,null,"text",{readonly:""}),null,"AJSSInfo")+W.getDiv(W.getSpan(C("ASPECT RATIO"))+W.getInput("AJSSAR")+W.getSpan(null,"AJSLockAR","AJSLock asicons-lock-open2"),null,"AJSSInfo"),"AJSWHAR","AJSEDivs")}function A(){var e=E?"<strong>"+J()+"</strong>":"",a=T?(e?" "+C("or")+" ":"")+"<strong>"+C("drop")+"</strong>":"",t=W.getSpan(C("Choose file")+(B?"":" "+W.getInput("AJSFileLegacy",null,null,"file")),"AJSChooseText","AJSBtnD")+W.getSpan(null,"AJSCloseText","AJSBtnD asicons-cross")+(e||a?W.getDiv(C("You can also")+" "+e+a+" "+C("the file"),"AJSUMore"):""),i=W.getDiv(W.getInput("AJSFile",null,P,"file")+W.getDiv(t,"AJSChooseFile"),"AJSChooseSection");return W.getDiv(i,"AJSUploadSection")+(T?W.getDiv(W.getHtml("a",C("DROP")),"AJSDropZone",P):"")}function J(){var e="(ctrl + v)";return navigator.platform.match(/Mac/i)&&(e="(cmd + v)"),C("paste")+" "+e}function C(e){return e}function w(e){return e.slice(-1)[0]}function y(e){if(e[0])return e[0];for(var a in e)if(e.hasOwnProperty(a))return e[a]}function x(e,a){for(var t=0;t<e.length;t++)if(e[t]===a)return!0;return!1}function I(e){return i.getElementById(e)}function H(e){return R("Object",e)}function b(e){return R("Array",e)}function R(e,a){if(void 0===a)return!1;var t=e.substr(0,1).toUpperCase()+e.substr(1).toLowerCase();return Object.prototype.toString.call(a)==="[object "+t+"]"}function k(e){return e.length>0}function D(e){var a=[];for(var t in e)e.hasOwnProperty(t)&&a.push(e[t]);return a}function L(e,a){var t;if(!e)return!1;try{t=JSON.parse(e)}catch(i){t=JSON.parse("'"+e+"'")}return t?a?D(t):t:!1}function F(e){var a=e;if(R("Array",a)){a={};for(var t=0,i=e.length;i>t;t++)e[t]&&(a[t]=e[t])}return JSON.stringify(a)}function W(){function e(e,a){if(H(a))for(var t in a)if(a.hasOwnProperty(t)){var i=a[t];"boolean"==typeof i&&(i=i?1:0),e.setAttribute(t,i)}}var a=this;this.getLink=function(e,t,i,n,o,l){return H(l)||(l={}),o&&(l.rel="nofollow"),l.href=t,a.getHtml("a",e,i,n,l)},this.getHtml=function(a,t,n,o,l){var r=i.createElement(a);return t&&(r.innerHTML=t),n&&(r.id=n),o&&(r.className=o),e(r,l),r.outerHTML},this.getInput=function(e,t,i,n,o){return H(o)||(o={}),(t||0===t)&&(o.value=t),e&&!o.name&&(o.name=e),o.type=n?n:"text",a.getHtml("input",null,e,i,o)},this.getSpan=function(e,t,i,n){return a.getHtml("span",e,t,i,n)},this.getDiv=function(e,t,i,n){return a.getHtml("div",e,t,i,n)}}var P="AJSHidden",Z=function(){},E="onpaste"in i,T="draggable"in i.createElement("span"),B=!!(a.Blob||a.File||a.FileList||a.FileReader),_=i.createElement("canvas"),M=!(!_.getContext||!_.getContext("2d")),U={VP_MAX_HEIGHT:420},G={accept:[".*"],allowFilters:!0,defaultCropHeightPer:.8,defaultCropWidthPer:.8,maxFileSize:2097152,maxFiles:1,iconPreviewHeight:200,iconPreviewWidth:200,maxHeight:1024,maxWidth:1024,onbeforeopen:Z,onclose:Z,onfilechanged:Z,onfilechanging:Z,onfileselected:Z,onfilesloaded:Z,onfilesloading:Z,oninit:Z,onlegacyuploadfail:Z,onlegacyuploadfinish:Z,onlegacyuploadstart:Z,onopen:Z,onsingleuploadfail:Z,onsingleuploadfinish:Z,onsingleuploadstart:Z,onuploadfail:Z,onuploadfinish:Z,onuploadprogress:Z,onuploadstart:Z,pathPrefix:"",quality:1,readonly:!1,showPreviewOnForm:!1,scale9Grid:!0,translateFunction:function(e){for(var a=1;a<arguments.length;a++){var t=new RegExp("\\{"+(a-1)+"\\}","g");e=e.replace(t,arguments[a])}return e},uploadScript:"/upload.php",uploadTo:"uploads"},O={init:function(o){function p(e){return Y.s.translateFunction.apply(null,arguments)}function h(a,t,n,o){var l;if(x(["CANVAS","IMG"],a[0].tagName)&&!n)l='<span id="'+t+'"><span></span></span>';else if("SPAN"===a[0].tagName&&n)l=i.createElement(o?"canvas":"img"),l.id=t;else if("IMG"===a[0].tagName&&o)l=i.createElement("canvas"),l.id=t;else{if("CANVAS"!==a[0].tagName||o)return a;l=i.createElement("img"),l.id=t}return a.after(l),a.remove(),e("#"+t)}function m(e,a,t){a.newsrc&&(t=new Image,t.src=a.newsrc);var i=l(t.width,t.height,Y.s.maxWidth,Y.s.maxHeight),n=e.getContext("2d");a.croppedWidth=a.resizedWidth=e.width=i.width,a.croppedHeight=a.resizedHeight=e.height=i.height,Y.multipass(e,n,t),(a.newupload||Y.existingedited)&&(a.newsrc=e.toDataURL(a.mimetype,Y.s.quality))}function v(a,t,n,o,l,r){if(e("#AJSLoading").removeClass(P),r&&o.canvasZoom){var s=o.canvasZoom,d=i.createElement("canvas"),c=d.getContext("2d");d.width=o.croppedWidth,d.height=o.croppedHeight,c.drawImage(n,l.x,l.y,l.outwidth,l.outheight),a.width=o.canvasWidth,a.height=o.canvasHeight,t.drawImage(d,s.x,s.y,s.width,s.height)}else t.drawImage(n,l.x,l.y,l.outwidth,l.outheight);o.newsrc=a.toDataURL(o.mimetype,Y.s.quality),e("#AJSLoading").addClass(P)}function f(e,a){switch(a){case"application/zip":case"application/gzip":return"asicons-file-zip";case"text/css":return"asicons-file-css";case"text/javascript":case"application/javascript":case"text/php":case"text/x-php":case"application/php":case"application/x-php":case"text/xml":case"text/html":return"asicons-code";case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":return"asicons-file-powerpoint";case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return"asicons-file-word";case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return"asicons-file-excel";case"application/pdf":case"application/x-pdf":case"application/vnd.pdf":return"asicons-file-pdf";case"application/vnd.oasis.opendocument.spreadsheet":case"application/vnd.oasis.opendocument.presentation":case"application/vnd.oasis.opendocument.text":return"asicons-file-openoffice"}switch(e){case"application":case"application-x":return"asicons-desktop";case"audio":return"asicons-microphone";case"model":return"asicons-tools";case"pdf":return"asicons-file-pdf";case"text":return"asicons-file-text-o";case"video":return"asicons-video";default:return"asicons-help"}}function S(e,a){var t=e.canvasWidth,i=e.canvasHeight,n=i?i:a.height,o=t?t:a.width,l=a.height,r=a.width,s=1;return n>U.VP_MAX_HEIGHT&&(s=n/U.VP_MAX_HEIGHT,n=U.VP_MAX_HEIGHT,o/=s,l/=s,r/=s),{height:n,thumbHeight:l,thumbWidth:r,width:o,scale:s}}function A(){var a=e(this),t=a[0].id.replace("AJSUploadBtn_","");Y.event("beforeopen",this,{elemid:t.replace(/^\d+_(.*)$/,"$1"),index:t.replace(/^(\d+)_.*/,"$1"),uploads:Y.uploads}),Y=ZZ.streams[t],ZZ.currentstream=Y;var i=e("#AJS");i.show(),i.css({marginTop:-(i.height()/2),marginLeft:-(i.width()/2)}),Y.uploads.length?Y.displayUpload():Y.resetToUpload(),Y.event("open",Y,{original:Y[0],uploads:Y.uploads,length:Y.uploads.length}),C(Y.s.readonly),a.hasClass("AJSFPBtn")&&e("#AJSFile").click()}function J(){var a=e(this)[0].id,t=a.replace(/.*\_(\d+)$/,"$1");a=a.replace(/\_\d+$/,"");var i=a.replace("AJSFP_","");Y.event("beforeopen",this,{elemid:i.replace(/^\d+_(.*)$/,"$1"),index:i.replace(/^(\d+)_.*/,"$1"),uploads:Y.uploads}),Y=ZZ.streams[i],ZZ.currentstream=Y,Y.currentupload=t;var n=e("#AJS");n.show(),n.css({marginTop:-(n.height()/2),marginLeft:-(n.width()/2)}),Y.displayUpload(Y.uploads[t]),e("#AJSMain > div").addClass(P),e("#AJSImagePreview").removeClass(P),Y.event("open",Y,{original:Y[0],uploads:Y.uploads,length:Y.uploads.length}),C(Y.s.readonly)}function C(a){var t=a?"addClass":"removeClass",i=Y.uploads[Y.currentupload];e("#AJSChange,#AJSRemove,#AJSEdit")[t](P),!a&&i&&(i.mimetype.match("image/*")&&"image/gif"!==i.mimetype&&M?e("#AJSEdit").removeClass(P):e("#AJSEdit").addClass(P))}function H(a){var t=U.VP_MAX_HEIGHT,i=a>t?t:a;e("#AJSRCVp").css({top:(t-i)/2})}function D(a){a.lastMove||e("#AJSCZ").streamBoundaries("reposition");var t=O(),i=Y.uploads[Y.currentupload],n=a.px||0===a.px?1*a.px:1,o=t.minWidth+t.width*n,l=t.minHeight+t.height*n,r=e("#AJSRCVp").streamBoundaries("updateOpts",{thumbHeight:l,thumbWidth:o}).streamBoundaries("reposition").positionData;i.edited=!0,i.canvasZoom={height:l*t.scale,width:o*t.scale,scalePercent:n,x:r.x*t.scale,y:r.y*t.scale}}function _(){var a=e("#AJSRCVp").streamBoundaries("getPositionData"),t=Y.uploads[Y.currentupload],i=O();t.canvasZoom||(t.canvasZoom={width:t.canvasWidth?t.canvasWidth:t.croppedWidth,height:t.canvasHeight?t.canvasHeight:t.croppedHeight,scalePercent:1}),t.canvasZoom.x=a.x*i.scale,t.canvasZoom.y=a.y*i.scale}function O(){var a,t,i=Y.uploads[Y.currentupload],n=i.croppedWidth,o=i.croppedHeight,r=i.canvasWidth?i.canvasWidth:n,s=i.canvasHeight?i.canvasHeight:o,d=n/o,c=1;if(n>o?(t=s,a=s*d,r>a&&(a=r,t=r/d)):(a=r,t=r/d,s>t&&(t=s,a=s*d)),s>U.VP_MAX_HEIGHT){var u=e("#AJSRITrack").streamBoundaries("getPositionData"),p=e("#AJSResImg"),h=p.is(":visible"),g=h?p.width():p.data("width"),m=h?p.height():p.data("height"),v=u.x2-u.x,f=u.y2-u.y,A=i.width,J=i.height;v*=A/g,f*=J/m;var C=l(v,f,Y.s.maxWidth,Y.s.maxHeight),w=S(i,C),y=t/U.VP_MAX_HEIGHT;t=U.VP_MAX_HEIGHT,a/=y,o=w.thumbHeight,n=w.thumbWidth,t>o&&(o=C.height,n=C.width),r>a&&(a=r/y,t=a/d),s>t&&(t=s/y,a=t*d),c=w.scale}return{width:n-a,height:o-t,minWidth:a,minHeight:t,scale:c}}function V(e){if(Y.s.readonly&&(e=!1),T&&(e?(i.body.ondragover=z,i.body.ondrop=j):(i.body.ondragover=null,i.body.ondrop=null)),E){var a=I("AJS");a.onpaste=e?N:null}}function z(a){var t=a.dataTransfer;(x(t.types,"Files")||x(t.types,"text/uri-list"))&&(e(a.target).closest(".AJSBtn,.AJSInlineDrop").parent().length?(e(".AJSInlineDrop").removeClass(P),e(".AJSBtn").addClass(P)):(e(".AJSInlineDrop").addClass(P),e(".AJSBtn").removeClass(P)),"AJSMainOverlay"===a.target.id?e("#AJSDropZone").addClass(P):(a.stopPropagation(),a.preventDefault(),t.dropEffect="copy",e("#AJSDropZone").removeClass(P)))}function j(a){a.stopPropagation(),a.preventDefault(),e(".AJSInlineDrop").css({display:"none"});var t=e(a.target);if(t.closest("#AJS,.AJSInlineDrop").length){if(e("#AJSLoading").removeClass(P),t.closest(".AJSInlineDrop").length){var i=t.parent().find(".AJSBtn");i.click().removeClass(P)}for(var n=a.dataTransfer,o=n.files,l=0;l<o.length;l++)o[l].type.match(Y.s.accept)||(o[l]=null);if(!o.length&&M){var r=Y.uploads.length+1;if(r>Y.s.maxFiles)return streamConfirm(p("Maximum files exceeded"),{Close:Z},p("You have selected {0} files but are only permitted to upload {1}",r,Y.s.maxFiles),{nocancel:!0}),e("#AJSDropZone").addClass(P),void e("#AJSLoading").addClass(P);V();var s=function(){V(!0)},d=n.getData("url");return d||(d=n.getData("text/plain"),d||(d=n.getData("text/uri-list")))?(Y.event("filesloading",null,{original:Y[0],toload:Y.toload,loaded:Y.loaded,uploads:Y.uploads,stream:Y}),e.ajax({url:Y.s.uploadScript+"?external=true",type:"post",dataType:"json",data:{filesrc:d,uploaddir:Y.s.uploadTo}}).done(function(a){if("OK"===a.result){s();var t=Y.uploads.length;if(a.data.index=t,Y.uploads[t]=a.data,Y.currentlength++,e("#AJSFile,#AJSFileLegacy").val(null),e("#AJSUploadSection").addClass(P),e("#AJSImagePreview").removeClass(P),Y.toggleLR(),Y.event("filesloaded",null,{loaded:Y.loaded,original:Y[0],uploads:Y.uploads,stream:Y}),Y.changing=!1,Y.toload=Y.loaded=0,a.data.mimetype.match("image/*")){var i=new Image;i.onload=function(){this.imageloaded=!0,ZZ.images["AJSIMG_"+Y.id+t]=i,Y.displayUpload(null,!0)},i.onerror=function(){Y.uploads.splice(t,1),streamConfirm(p("Error"),{Close:s},p("There was an error processing the external file you dropped"),{nocancel:!0})},i.src=a.data.src+"?cachekill="+(new Date).getTime()}else Y.displayUpload(null,!0)}else streamConfirm(p("Error"),{Close:s},p("There was an error processing the external file you dropped"),{nocancel:!0})}).fail(function(){e("#AJSLoading").addClass(P),streamConfirm(p("Error"),{Close:s},p("There was an error processing the external file you dropped"),{nocancel:!0})}),void e("#AJSDropZone").addClass(P)):void e("#AJSLoading").addClass(P)}e("#AJSDropZone").addClass(P),Y.addingmore=!0,Y.filechanged.call(null,{eventType:"drop",originalEvent:a,target:{files:o}})}}function N(e){for(var a=e.clipboardData.items,t=a.length,i=0;i<a.length;i++)a[i].type.match(Y.s.accept)||(a[i]=null,t--);if(t){Y.toload=t,Y.loaded=0;var n=t+Y.uploads.length;n>Y.s.maxFiles&&(streamConfirm(p("Maximum files exceeded"),{Close:Z},p("You have selected {0} files but are only permitted to upload {1}",n,Y.s.maxFiles),{nocancel:!0}),t=Y.toload=Y.s.maxFiles-Y.uploads.length);for(var i=0;t>i;i++){var o=a[i];if(o){var l=o.getAsFile();l&&l.size?(Y.addingmore=!0,Y.process(l,i)):streamConfirm(p("Error"),{Close:Z},p("There was an error processing the file you pasted"),{nocancel:!0})}}}}function $(){var a="AJSIMG_"+Y.id+Y.currentupload,t=e("#"+a);t.is(":visible")&&t.css({top:(500-t.height())/2});var i=e("#AJS");i.css({marginLeft:-(i.width()/2),marginTop:-(i.height()/2)})}function X(){var e="",a=Y.uploads,t=parseFloat(Y.s.iconPreviewHeight),i=parseFloat(Y.s.iconPreviewWidth),n=0;for(var o in a){var l,r=a[o],s=r.mimetype.replace(/\/.*$/,""),d="image"===s;if(d){var c,u=r.canvasWidth?r.canvasWidth:r.croppedWidth,h=r.canvasHeight?r.canvasHeight:r.croppedHeight;if(h>u)c="height: 100%;width: auto;";else{var g=u/h,h=i/g;c="width: 100%;height: auto;margin-top:"+(t-h)/2+"px;"}l=W.getHtml("img",null,null,null,{src:r.newsrc,style:c})}else l=W.getSpan(null,null,f(s,r.mimetype),{style:"line-height:"+t+"px;font-size:"+(i-20)+"px;"});l+=W.getDiv(r.name,null,"AJSFPName"),e+=W.getDiv(l,"AJSFP_"+Y.id+"_"+r.index,"AJSFP",{style:"width:"+i+"px;height:"+t+"px;"}),n++}return Y.s.maxFiles&&a.length+1<=Y.s.maxFiles&&Y.uploads.length&&B&&(e+=W.getSpan(null,"AJSUploadBtn_"+Y.id,"asicons-plus AJSBtn AJSFPBtn",{"data-ajaxstreamid":Y.c})),n||(e+=W.getSpan(p("Upload"),"AJSUploadBtn_"+Y.id,"AJSBtn",{"data-mandatory":!0,"data-ajaxstreamid":Y.c})+W.getSpan(p("Drop"),"AJSDropZone_"+Y.id,"AJSInlineDrop "+P)),e}var Y=this;if(Y.length>1)return Y.each(function(){e(this).ajaxStream(o)}),Y;if(!Y.length)return Y;var q=e("body");return Y.c=t,Y.currentupload=null,Y.currentlength=0,Y.changing=!1,Y.toload=0,Y.loaded=0,Y.uploads=[],Y.addingmore=!1,Y.existingedited=!1,Y.s=e.extend(e.extend({},G),o),Y.id=[Y.c,"_",Y.prop("id")].join(""),Y.filedata={},Y.event=function(e,a){return Y.s["on"+e].apply(a,Array.prototype.slice.call(arguments,2))},Y.legacyUpload=function(t){var i=Y.changing===!1?Y.uploads.length:Y.changing;Y.filedata={aspectRatioLocked:!1,base64:null,canvasWidth:null,canvasHeight:null,canvasZoom:null,croppedWidth:null,croppedHeight:null,index:i,islegacy:!0,mimetype:null,name:null,newupload:!0,resizedWidth:null,resizedHeight:null,size:null},a.AJSLegacy=ZZ.streams[Y.id],e("#AJSLegacy").val(JSON.stringify({maxsize:Y.s.maxFileSize,maxheight:Y.s.maxHeight,maxwidth:Y.s.maxWidth,uploaddir:Y.s.uploadTo,islegacy:!0,id:Y.id}));var n=e("#AJSFileLegacy"),o=n.clone();o.insertAfter(n),n[0].id=null,e("#AJSLegacyForm").prop({action:Y.s.uploadScript+"?newupload=true"}).append(n),o.unbind("change",Y.filechanged).change(Y.filechanged),Y.event("legacyuploadstart",t,{original:Y[0],stream:Y,uploads:Y.uploads}),I("AJSLegacyForm").submit(),e("#AJSLoading").removeClass(P)},Y.afterLegacyUpload=function(t){e("input[name=AJSFileLegacy]","#AJSLegacyForm").remove(),e("#AJSLoading").addClass(P),t.moved?(t.mimetype.match("image/*")&&(Y.filedata.croppedWidth=Y.filedata.resizedWidth=t.width,Y.filedata.croppedHeight=Y.filedata.resizedHeight=t.height),Y.currentlength++,Y.filedata.newsrc=t.location,Y.filedata.src=t.location,Y.filedata.name=t.name,Y.filedata.size=t.size,Y.filedata.mimetype=t.mimetype,Y.filedata.src=t.location,Y.event("legacyuploadfinish",Y,{original:Y[0],results:t,uploads:Y.uploads}),Y.afterFileRead(Y.filedata,Y.changing!==!1),a.AJSLegacy=null):(Y.event("legacyuploadfail",null,{original:Y[0],error:t.error,results:t,uploads:Y.uploads,stream:Y}),streamConfirm(p("Error"),{Close:Z},t.error,{nocancel:!0}))},Y.filechanged=function(e){var a=e.target.files;if(!a&&e.target.value.match(/^.\:\\/))return Y.legacyUpload(this),void(Y.toload=1);if(!a.length)return void(Y.changing=!1);var t=Y.toload=a.length;if(Y.event("fileselected",this,{originalEvent:e.originalEvent,files:a,toload:Y.toload,original:Y[0],stream:Y,jQueryEvent:e,uploads:Y.uploads}),B){for(var i=0;t>i;i++)a[i]||Y.toload--;if(Y.toload<=0&&streamConfirm(p("Error"),{Close:Z},p("There was an error during the upload: the file list is empty"),{nocancel:!0}),Y.changing===!1){t=Y.toload;var n=t+Y.uploads.length;n>Y.s.maxFiles&&(streamConfirm(p("Maximum files exceeded"),{Close:Z},p("You have selected {0} files but are only permitted to upload {1}",n,Y.s.maxFiles),{nocancel:!0}),t=Y.toload=Y.s.maxFiles-Y.uploads.length);for(var i=0;t>i;i++)a[i]&&Y.process(a[i],i)}else Y.event("filechanging",this,{originalEvent:e.originalEvent,file:a[0],current:Y.uploads[Y.changing],original:Y[0],jQueryEvent:e,stream:Y,uploads:Y.uploads}),Y.process(a[0],Y.changing,!0,this)}else Y.legacyUpload(this)},Y.process=function(t,n,o,r){if(e("#AJSLoading").removeClass(P),R("blob",t)||R("file",t)){var s=new FileReader,d=t.type.match("image/*")&&"image/gif"!==t.type;s.onload=function(e){var s=new Blob([e.target.result],{type:t.type}),c=(a.URL||a.webkitURL).createObjectURL(s),u=o?n:null,p={aspectRatioLocked:!1,edited:!1,index:u,islegacy:!1,mimetype:t.type,name:t.name,newupload:!0,size:t.size,src:c};if(o||Y.currentlength++,d){var h=new Image,g=i.createElement("canvas"),m=g.getContext("2d");h.onload=function(){var e=this,a=l(h.width,h.height,Y.s.maxWidth,Y.s.maxHeight);e.imageloaded=!0,p.width=p.resizedWidth=p.croppedWidth=e.width,p.height=p.resizedHeight=p.croppedHeight=e.height,p.canvasWidth=p.canvasHeight=p.canvasZoom=null,p.cropdata={},p.image=e,g.width=a.width,g.height=a.height,Y.multipass(g,m,h),p.newsrc=g.toDataURL(p.mimetype,1),Y.afterFileRead(p,o,r)},h.onerror=function(){p.src=null,Y.afterFileRead(p,o,r)},h.src=c}else p.newsrc=e.target.result,Y.afterFileRead(p,o,r)},s.onerror=function(a){var t=a.currentTarget.error;e("#AJSLoading").addClass(P),streamConfirm(p("Error"),{Close:Z},p("There was an error processing the selected file.\n                        Make sure what you selected was indeed a file. Full details")+": "+t.message,{nocancel:!0}),console.error(t.name+": "+t.message)},d?s.readAsArrayBuffer(t):s.readAsDataURL(t)}else streamConfirm(p("Error"),{Close:Z},p("The selection is not a file"),{nocancel:!0})},Y.afterFileRead=function(e,a,t){var i,n=null;a?(i=e.index,n=Y.uploads[i],Y.uploads[i]=e):(i=Y.uploads.length,e.index=i,Y.uploads[i]=e),ZZ.images["AJSIMG_"+Y.id+i]=e.image,delete e.image,Y.attemptProgression(t,e.index,n)},Y.attemptProgression=function(a,t,i){if(Y.loaded++,Y.event("filesloading",a,{original:Y[0],toload:Y.toload,loaded:Y.loaded,uploads:Y.uploads,stream:Y}),Y.loaded===Y.toload){e("#AJSFile,#AJSFileLegacy").val(null),e("#AJSLoading").addClass(P),e("#AJSUploadSection").addClass(P),e("#AJSImagePreview").removeClass(P),Y.toggleLR();var n=Y.changing===!1;Y.changing===!1&&Y.event("filechanged",a,{original:Y[0],newfile:Y.uploads[t],oldfile:i,uploads:Y.uploads,stream:Y}),Y.event("filesloaded",a,{loaded:Y.loaded,original:Y[0],uploads:Y.uploads,stream:Y}),Y.changing=!1,Y.toload=Y.loaded=0,Y.displayUpload(null,n)}},Y.toggleLR=function(){Y.uploads.length>1?e("#AJSLRContainer").removeClass(P):e("#AJSLRContainer").addClass(P)},Y.displayUpload=function(a,t){if(Y.uploads.length){a||(a=Y.getCurr(t)),e("#AJSAdd")[Y.currentlength+1>Y.s.maxFiles?"addClass":"removeClass"](P);var i=a.mimetype.match("image/*"),n=i?"image/gif"===a.mimetype?a.newsrc:a.src:null;Y.toggleLR(),n||!i&&!n?(Y.drawImage(a,n),Y.currentupload=a.index):streamConfirm(p("Corrupt upload"),{ok:Y.deleteUpload},p("There is no source for this upload meaning that you cannot continue. Click 'ok' to delete"),{nocancel:!0})}else Y.resetToUpload()},Y.drawImage=function(a,t){var i="AJSIMG_"+Y.id+a.index,n=a.mimetype.replace(/\/.*$/,""),o="image"===n,l=B&&M&&o&&"image/gif"!==a.mimetype,r=e("#"+i),s=e("#AJSEdit");if(s.addClass(P),r.length)r=h(r,i,o,l);else{var d="";d=l?'<canvas id="'+i+'"></canvas>':a.mimetype.match("image/*")?'<img id="'+i+'"/>':'<span id="'+i+'"><span></span></span>',e("#AJSLRContainer").before(d),r=e("#"+i)}l?(s.removeClass(P),m(r[0],a,ZZ.images[i])):"image"===n?r[0].src=t:(r.attr({"class":"AJSMIMEIcons "+f(n,a.mimetype)}),r.find("span").html(a.name)),e('[id^="AJSIMG_"]').addClass(P);var c="CANVAS"===r[0].tagName?r[0].height:r.height();c||(c=a.croppedHeight),r.removeClass(P).css({top:c>500?0:(500-c)/2}),e("#AJSLoading").addClass(P),$()},Y.setCropped64=function(a,t,i,n,o){if(M){var r=a.getContext("2d"),s=e("#AJSResImg"),d=s.is(":visible"),c=d?s.width():s.data("width"),u=d?s.height():s.data("height"),p=n.x2-n.x,h=n.y2-n.y,g=t.width,m=t.height;p*=g/c,h*=m/u;var f=l(p,h,Y.s.maxWidth,Y.s.maxHeight),S=f.width,A=f.height,J=S/p,C=A/h,w=-n.x*(g/c)*J,y=-n.y*(m/u)*C,x=g*J,I=m*C;t.croppedWidth=a.width=S,t.croppedHeight=a.height=A,i.imageloaded?v(a,r,i,t,{x:w,y:y,outwidth:x,outheight:I},o):(e("#AJSLoading").removeClass(P),i.onload=function(){i.imageloaded=!0,v(a,r,i,t,{x:w,y:y,outwidth:x,outheight:I},o),e("#AJSLoading").addClass(P)})}},Y.multipass=function(e,a,t,o,l,r,s){var d=r?r:e.width,c=s?s:e.height,u=void 0===o?0:n.floor(o),p=void 0===l?0:n.floor(l);if(t.width/d>2||t.height/d>2){var h=i.createElement("canvas"),g=h.getContext("2d");h.width=.5*t.width,h.height=.5*t.height,g.drawImage(t,u,p,h.width,h.height),g.drawImage(h,0,0,.5*h.width,.5*h.height),a.drawImage(h,0,0,.5*h.width,.5*h.height,.75*u,.75*p,d,c)}else a.drawImage(t,u,p,d,c)},Y.resetToUpload=function(){var a=e("#AJSRContainer");e("#AJSUploadSection").removeClass(P),e("#AJSImagePreview").addClass(P),e("#AJSChooseText").removeClass(P),e("#AJSLoading").addClass(P),Y.uploads.length?a.removeClass(P):a.addClass(P)},Y.getCurr=function(e){if(e)return Y.currentupload=Y.uploads.length-1,Y.uploads[Y.currentupload];if(Y.addingmore){var a=w(Y.uploads);return Y.currentupload=a.index,a}return Y.currentupload||0===Y.currentupload?Y.uploads[Y.currentupload]:(Y.currentupload=0,y(Y.uploads))},Y.changePrev=function(e){var a,t=e?-1:1;Y.currentupload+t<0?(a=w(Y.uploads),Y.currentupload=Y.uploads.length-1):Y.currentupload+t>Y.uploads.length-1?(a=y(Y.uploads),Y.currentupload=0):(a=Y.uploads[Y.currentupload+t],Y.currentupload+=t),Y.displayUpload(a)},Y.iconClick=function(){Y=ZZ.currentstream;var a=e(this),t=e(".EIconActive");if(t.data("for")===a.data("for"))return!1;e("#AJSLoading").removeClass(P);var n=e("#AJSRInner"),o=e("#AJSRC");switch(e(".AJSEDivs").addClass(P),e("#"+a.data("for")).removeClass(P),a.data("for")){case"AJSRCan":var r=e("#AJSRITrack").streamBoundaries("getPositionData"),s=Y.uploads[Y.currentupload],d=s.canvasZoom,c=d?d.scalePercent:!1,u=s.canvasWidth,p=s.canvasHeight,h=e("#AJSResImg"),g=h.width(),m=h.height(),v=u&&p&&null===d,f=r.x2-r.x,A=r.y2-r.y,J=s.width,C=s.height;f*=J/g,A*=C/m;var w=l(f,A,Y.s.maxWidth,Y.s.maxHeight),y=S(s,w);if(h.attr({"data-width":g,"data-height":m}),Y.setCropped64(i.createElement("canvas"),s,ZZ.images["AJSIMG_"+Y.id+Y.currentupload],r),n.addClass(P),o.removeClass(P),I("AJSRCImg").src=s.newsrc,I("AJSCW").value=u?u:s.croppedWidth,I("AJSCH").value=p?p:s.croppedHeight,e("#AJSRCVp").streamBoundaries("updateOpts",{height:y.height,thumbHeight:y.thumbHeight,thumbWidth:y.thumbWidth,width:y.width}),c||0===c||v){c=v?1:c;var x=e("#AJSCZ").streamBoundaries("reposition",{x:100*c+"%"});D.call(x,x.positionData)}H(p?p:w.height);break;case"AJSWHAR":o.addClass(P),n.removeClass(P)}t.removeClass("EIconActive"),a.addClass("EIconActive"),e("#AJSLoading").addClass(P)},Y.fillEditValues=function(e,a){if(a){var t=Y.getScaledDimensions(a,e);I("AJSSAR").value=c(t.aspectRatio),I("AJSSW").value=t.width,I("AJSSH").value=t.height}},Y.getScaledDimensions=function(e,a){var t=e.rect,i=t.width,n=t.height,o=r((e.x2-e.x)*(a.width/i)),s=r((e.y2-e.y)*(a.height/n)),d=Y.s.maxWidth,c=Y.s.maxHeight,u=l(o,s,d,c);return o=u.width,s=u.height,{width:o,height:s,aspectRatio:o/s}},Y.showInfo=function(){e(".AJSEIcon:first").click(),e("#AJSLoading").removeClass(P);var t=Y.uploads[Y.currentupload],n=t.cropdata,o=e("#AJSResImg"),l=e("#AJSRInner"),r=e("#AJSRITrack"),d=ZZ.images["AJSIMG_"+Y.id+Y.currentupload],c=W.getHtml("img",null,"AJSResImg",null,{src:d.src,"data-top":o.attr("data-top"),"data-bottom":o.attr("data-bottom"),"data-width":o.attr("data-width"),"data-height":o.attr("data-height"),style:o.attr("style")}),u=e("#AJSLockAR");e("#AJSMain > div").addClass(P),e("#AJSMore").removeClass(P),o.remove(),l.prepend(c),o=e("#AJSResImg"),l.hide(),o[0].onload=function(){e("#AJSLoading").addClass(P),l.show(),o.css({maxWidth:parseFloat(e(a).width())-20}),l.css({width:"auto"});var d=o[0].getBoundingClientRect(),c=d.width,p=d.height,h=Y.s.defaultCropWidthPer,g=Y.s.defaultCropHeightPer,m=void 0!==n.x?n.x2-n.x:c*(h>1?1:h),v=void 0!==n.y?n.y2-n.y:p*(g>1?1:g);r.streamBoundaries("updateOpts",{width:c,height:p,thumbWidth:m,thumbHeight:v,onFinish:function(e){e.rect=d,Y.fillEditValues(t,e),s(e),Y.uploads[Y.currentupload].canvasZoom=null}}),l.width(c);var f=r.streamBoundaries("reposition",{x:n.x||0===n.x?n.x:(1-h)/2*100,y:n.y||0===n.y?n.y:(1-g)/2*100}).positionData;s(f),f.rect=d,Y.fillEditValues(t,f),t.aspectRatioLocked?u.removeClass("asicons-lock-open2").addClass("asicons-lock2"):u.removeClass("asicons-lock2").addClass("asicons-lock-open2"),e(".AJSEIcon").removeClass("EIconActive").first().click();var S=e("#AJS"),A=(parseFloat(l.height())-p)/2;e("#AJSRBG").css({top:-p,height:p}),S.css({minWidth:c>340?c:340,marginLeft:-(S.width()/2)}),o.css({marginTop:A}).attr({"data-top":A,"data-bottom":A+p}),r.css({marginTop:A}),$(),T&&(i.body.ondragover=null,i.body.ondrop=null),V()},o[0].src=d.src},Y.saveInfo=function(){var a=Y.uploads[Y.currentupload],t=e("#AJSRITrack").streamBoundaries("getPositionData"),i="AJSIMG_"+Y.id+Y.currentupload,n=e("#"+i);if(!ZZ.images[i]){var o=new Image;o.onload=function(){this.imageloaded=!0},o.src=a.src+"?cachekill="+(new Date).getTime(),ZZ.images[i]=o}Y.setCropped64(I(i),a,ZZ.images[i],t,!0);var l={x:t.x,x2:t.x2,y:t.y,y2:t.y2};a.cropdata!==l&&(a.edited=!0,Y.edited=!0),a.cropdata=l,e("#AJSMain > div").addClass(P),e("#AJSImagePreview").removeClass(P),e("#AJS").css({minWidth:"initial"}),n.css({top:(500-n.height())/2}),$(),V(!0),e.streamBoundaries.unsetMouseMove()},Y.deleteUpload=function(){for(var a=[],t=!1,i=!1,n=0,o=Y.uploads.length;o>n;n++)if(Y.uploads[n]&&n!==Y.currentupload){var l=Y.uploads[n];l.index=a.length,a.push(l),i!==!1&&t!==!1&&(i=n)}else t=n;e("#AJSIMG_"+Y.id+Y.currentupload).remove(),Y.uploads=a,Y.currentlength=Y.uploads.length,Y.currentupload=i!==!1?i:0,e("#AJS_"+Y[0].id).val(F(Y.uploads)),e("#AJSUploadSection").addClass(P),e("#AJSImagePreview").removeClass(P),Y.toggleLR(),Y.displayUpload()},Y.initBinding=function(){var t=e(B?"#AJSFile":"#AJSFileLegacy");t.unbind("click").click(function(){var a=Y.s.accept;(".*"===a||b(a)&&x(a,".*"))&&(a="*");var t={accept:a};Y.s.maxFiles>1&&(t.multiple=!0),e(this).attr(t)}),B&&e("#AJSChooseText").unbind("click").click(function(){Y.addingmore=!0,Y.changing=!1,t.click()}),V(!0),t.unbind("change").change(Y.filechanged),e("#AJSImagePreview").unbind("dbclick").dblclick(function(){a.getSelection?a.getSelection().removeAllRanges():i.selection&&i.selection.empty()}),e("#AJSAdd").unbind("click").click(function(){Y.uploads.length+1<=Y.s.maxFiles&&(t.click(),Y.addingmore=!0)}),e("#AJSChange").unbind("click").click(function(){Y.changing=Y.currentupload,Y.addingmore=!1,t.click()}),e("#AJSL").unbind("click").click(function(){Y.changePrev(!0)}),e("#AJSR").unbind("click").click(function(){Y.changePrev()});var n=I("AJSICancel"),o=I("AJSISave"),d=I("AJSCW"),c=I("AJSCH"),u=I("AJSSAR"),h=I("AJSEdit");h&&(h.onclick=Y.showInfo),n&&(n.onclick=function(){e("#AJSMain > div").addClass(P),e("#AJSImagePreview").removeClass(P);var a=e("#AJSIMG_"+Y.id+Y.currentupload);e("#AJS").css({minWidth:"initial"}),a.css({top:(500-a.height())/2}),$(),V()}),o&&(o.onclick=Y.saveInfo),e("#AJSRemove").unbind("click").click(function(){streamConfirm(p("Are you sure you want to remove this file?"),Y.deleteUpload,p("This removes the file from the list of files to be uploaded, and not from your computer"))}),e("#AJSClose,#AJSCloseText").unbind("click").click(function(){Y.s.readonly||e("#AJS_"+Y[0].id).val(F(Y.uploads)),e("#AJS").hide(),Y.s.showPreviewOnForm&&(e("#AJSFormPrev_"+Y.id).html(X()),e("[id^=AJSUploadBtn_]").unbind("click",A).click(A),e(".AJSFP").unbind("click",J).click(J)),Y.event("close",Y,{original:Y[0],uploads:Y.uploads,length:Y.uploads.length})}),e("[id^=AJSUploadBtn_]").unbind("click",A).click(A),e(".AJSFP").unbind("click",J).click(J),u&&(u.onchange=function(){e("#AJSLockAR").removeClass("asicons-lock-open2").addClass("asicons-lock2");var a,t=this.value,i=e("#AJSRITrack").streamBoundaries("getPositionData"),n=Y.uploads[Y.currentupload];if(n.aspectRatioLocked=!0,t&&t.match(/^(:?\s+)?\d+(:?\.\d+)?(:?\/|\:)\d+(:?\.\d+)?$/)){var o=t.split(/[\/|\:]/);a=o[0]/o[1]}else{if(!t||!t.match(/^(:?\s+)?(:?\d+|\d+\.\d+)$/))return;a=1*t}var l=I("AJSResImg").getBoundingClientRect(),d=n.width/l.width,c=n.height/l.height,u=i.x2-i.x,p=r(u/a),h=!1,g=!1;p+i.y>l.height&&(g=l.height-p,p>l.height&&(p=l.height,u=r(p*a),g=0,u+i.x>l.width&&(h=l.width-u)));
var m=e("#AJSRITrack").streamBoundaries("updateOpts",{thumbWidth:u,thumbHeight:p,x:h,y:g}).positionData;I("AJSSW").value=r(u*d),I("AJSSH").value=r(p*c),s(m)}),d&&(d.onchange=function(){var a=1*this.value,t=a>Y.maxWidth?Y.maxWidth:a,i=I("AJSCH"),n=1*i.value,o=Y.uploads[Y.currentupload],r=l(t,n,Y.s.maxWidth,Y.s.maxHeight,o);this.value=o.canvasWidth=r.width,i.value=o.canvasHeight=r.height;var s=S(o,r),d=e("#AJSCZ").streamBoundaries();e("#AJSRCVp").streamBoundaries("updateOpts",{height:s.height,thumbHeight:s.thumbHeight,thumbWidth:s.thumbWidth,width:s.width}),H(r.height),e("#AJSRCVp").streamBoundaries("reposition"),D.call(d,d.positionData)}),c&&(c.onchange=function(){var a=1*this.value,t=a>Y.s.maxHeight?Y.s.maxHeight:a,i=I("AJSCW"),n=1*i.value,o=Y.uploads[Y.currentupload],r=l(n,t,Y.s.maxWidth,Y.s.maxHeight,o);this.value=o.canvasHeight=r.height,i.value=o.canvasWidth=r.width;var s=S(o,r),d=e("#AJSCZ").streamBoundaries();e("#AJSRCVp").streamBoundaries("updateOpts",{height:s.height,thumbHeight:s.thumbHeight,thumbWidth:s.thumbWidth,width:s.width}),H(r.height),e("#AJSRCVp").streamBoundaries("reposition"),D.call(d,d.positionData)}),e("#AJSLockAR").click(function(){var a=e(this),t=a.hasClass("asicons-lock-open2");t?a.removeClass("asicons-lock-open2").addClass("asicons-lock2"):a.removeClass("asicons-lock2").addClass("asicons-lock-open2"),Y.uploads[Y.currentupload].aspectRatioLocked=t}),e(".AJSEIcon").unbind("click",Y.iconClick).click(Y.iconClick),e(window).unbind("resize",$).resize($)},Y.redraw=function(){e("#AJSFormPrev_"+Y.id).html(X()),e("[id^=AJSUploadBtn_]").unbind("click",A).click(A),e(".AJSFP").unbind("click",J).click(J)},Y.draw=function(){if(Y.addClass(P),Y.attr({"data-ajaxstreamid":Y.c}),k(e("#AJS_"+Y[0].id))){var a=e("#AJS_"+Y[0].id).val();Y.uploads=a.length?L(a,!0):[],Y.currentlength=Y.uploads.length;for(var t=0;t<Y.currentlength;t++){var i=Y.uploads[t];if(i.cropdata||(i.cropdata={}),i.mimetype.match("image/*")){var n=new Image;n.onload=function(){this.imageloaded=!0},n.src=i.src+"?cachekill="+(new Date).getTime(),ZZ.images["AJSIMG_"+Y.id+t]=n}}}else e(W.getInput("AJS_"+Y[0].id,null,null,"hidden")).insertAfter(Y[0]);Y.s.showPreviewOnForm?e(W.getDiv(X(),"AJSFormPrev_"+Y.id,"AJSFormPrev",{style:"height:"+Y.s.iconPreviewHeight})).insertAfter(Y[0]):e(W.getSpan(p("Upload"),"AJSUploadBtn_"+Y.id,"AJSBtn",{"data-mandatory":!0,"data-ajaxstreamid":Y.c})).insertAfter(Y[0]),k(e("#AJS"))||(q.append(W.getDiv(u(Y.s.pathPrefix),"AJS")),B?e("#AJSImagePreview").after(g()):d(),e("#AJSRITrack").streamBoundaries({width:"100%",height:"100%",orientation:"2d",resizable:!0,bg:"none",thumbBg:"none",round:!1,scale9Grid:Y.s.scale9Grid,onBeforeUpdate:function(){Y=ZZ.currentstream,this.s.lockAspectRatio=Y.uploads[Y.currentupload].aspectRatioLocked},onUpdate:function(e){s(e)}}),e("#AJSRCVp").streamBoundaries({crosshair:!1,height:"100%",isViewport:!0,orientation:"2d",onFinish:_,thumbBorder:"none",width:"100%"}),e("#AJSCZ").streamBoundaries({bg:"#999",crosshair:!1,height:8,onFinish:D,onUpdate:D,thumbBg:"#444",thumbBorder:"none",thumbBorderRadius:3,thumbHeight:8,thumbWidth:"15%",trackBorderRadius:3,width:"100%",x:"85%"})),Y.initBinding(),Y.event("init",Y,{original:Y[0],uploads:Y.uploads})}(),ZZ.streams[Y.id]=Y,t++,Y},setUploadData:function(e,a){var t=this;R("string",e)&&(e=L(e)),t.uploads=e?D(e):[];for(var i=0;i<t.uploads.length;i++)if(t.uploads[0].mimetype.match("image/*")){var n=new Image,o=t.uploads[0].src;n.onload=function(){this.imageloaded=!0},n.src=o.match(/^blob\:/)?o:o+"?cachekill="+(new Date).getTime(),ZZ.images["AJSIMG_"+t.id+i]=n}t.currentlength=t.uploads.length,t.toload=t.loaded=t.currentupload=0,a&&t.redraw()}};e.fn.ajaxStream=function(a){var t=o(this);return O[a]?O[a].apply(t,Array.prototype.slice.call(arguments,1)):"[object Object]"!==Object.prototype.toString.call(a)&&a?void e.error(["The method ",a," does not exist"].join("")):O.init.apply(t,arguments)},window.ZZ=e.ajaxStream={author:"Luke Madhanga",currentstream:null,images:{},license:"MIT",streams:{},setDefaults:function(a){G=e.extend(G,a)},version:"2.0.1"},W=new W}(jQuery,this,0,document,Math);