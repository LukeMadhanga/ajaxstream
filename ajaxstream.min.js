!function(e,a,t,i,n){function o(e){var a=e.data("ajaxstreamid");return a?ZZ.streams[a+"_"+e[0].id]:e}function l(e,a,t,i,o){var l=1*e,s=1*a;return o&&(t=t>o.width?o.width:t,i=i>o.height?o.height:i),l>s?l>t&&(s=r(s*=t/l),l=t):s>i&&(l=r(l*=i/s),s=i),{width:n.round(l),height:n.round(s)}}function r(e){return n.round(e)}function s(a){var t=a.x2-a.x;e("#AJSCropT").css({width:t,height:a.y,left:a.x,top:0}),e("#AJSCropR").css({width:a.trackWidth-a.x2,height:a.trackHeight,right:0,top:0}),e("#AJSCropB").css({width:t,height:a.trackHeight-a.y2,left:a.x,bottom:0}),e("#AJSCropL").css({width:a.x,height:a.trackHeight,left:0,top:0})}function d(e,a,t){if(!window.atob||!window.Uint8Array)return null;a=a||"",t=t||512;for(var i=atob(e.replace(/^data:[a-z09\/-]+;base64,/,"")),n=[],o=0;o<i.length;o+=t){for(var l=i.slice(o,o+t),r=new Array(l.length),s=0;s<l.length;s++)r[s]=l.charCodeAt(s);var d=new Uint8Array(r);n[n.length]=d}return new Blob(n,{type:a})}function c(){if(!D(e("#AJSLegacy"))){var a={method:"post",enctype:"multipart/form-data",target:"AJSIFrame",name:"AJSLegacyForm",action:"/upload.php"};e("body").append(Z.getHtml("form",Z.getInput("AJSLegacy",null,null,"hidden")+Z.getInput(null,"submit",null,"submit"),"AJSLegacyForm",P,a)+Z.getHtml("iframe",null,"AJSIFrame",P,{name:"AJSIFrame"}))}}function u(e){var a,t,i,o,l,r,s,d=1e-15,c=e;for(s=n.floor(c),t=1,l=0,a=s,o=1;c-s>d*o*o;)c=1/(c-s),s=n.floor(c),i=t,t=a,r=l,l=o,a=i+s*t,o=r+s*l;return a+":"+o}function h(e){var a=p()+J();return Z.getDiv(null,"AJSMainOverlay")+Z.getDiv(a+Z.getHtml("img",null,"AJSLoading",P,{src:e+"/files/loader.gif",title:C("Files are loading")}),"AJSMain")}function p(){var e=g()+Z.getDiv(Z.getSpan(null,"AJSL","AJSLR asicons-arrow-left")+Z.getSpan(null,"AJSR","AJSLR asicons-arrow-right"),"AJSLRContainer");return Z.getDiv(e,"AJSImagePreview",P)}function g(){return Z.getDiv(Z.getDiv(null,"AJSActionsOverlay")+Z.getDiv((B?Z.getSpan(null,"AJSAdd","asicons-plus",{title:C("Add another file")}):"")+(B?Z.getSpan(null,"AJSChange","asicons-docs",{title:C("Change file")}):"")+(U?Z.getSpan(null,"AJSEdit","asicons-pencil",{title:C("Edit")}):"")+Z.getSpan(null,"AJSRemove","asicons-trash",{title:C("Remove file")})+Z.getSpan(null,"AJSClose","asicons-checkmark",{title:C("Close window")})),"AJSPreviewActions")}function m(){var e="";return e+=Z.getDiv(Z.getDiv(Z.getDiv(Z.getHtml("img",null,"AJSResImg")+Z.getDiv(Z.getDiv(null,"AJSCropT")+Z.getDiv(null,"AJSCropR")+Z.getDiv(null,"AJSCropB")+Z.getDiv(null,"AJSCropL"),"AJSRBG")+Z.getDiv(Z.getDiv(),"AJSRITrack"),"AJSRInner")+Z.getDiv(Z.getDiv(Z.getDiv(Z.getHtml("img",null,"AJSRCImg")),"AJSRCVp"),"AJSRC",P)+Z.getDiv(v()+f(),"AJSScaleInfo"),"AJSRIHolder"),"AJSInfo"),Z.getDiv(e+Z.getDiv(Z.getSpan(null,"AJSISave","asicons-checkmark")+Z.getSpan(null,"AJSICancel","asicons-cross"),"AJSIBtns"),"AJSMore",P)}function v(){return Z.getDiv(Z.getSpan(null,null,"AJSEIcon asicons-transform",{"data-for":"AJSWHAR",title:C("Crop Image")})+Z.getSpan(null,null,"AJSEIcon asicons-flip-to-front",{"data-for":"AJSRCan",title:C("Resize canvas")}),"AJSEditIcons")}function f(){return A()+S()}function S(){return Z.getDiv(Z.getDiv(Z.getSpan(C("CANVAS WIDTH"))+Z.getInput("AJSCW"),null,"AJSSInfo")+Z.getDiv(Z.getSpan(C("CANVAS HEIGHT"))+Z.getInput("AJSCH"),null,"AJSSInfo")+Z.getDiv(Z.getSpan(C("ZOOM"))+Z.getDiv(Z.getDiv(),"AJSCZ"),null,"AJSSInfo"),"AJSRCan","AJSEDivs AJSHidden")}function A(){return Z.getDiv(Z.getDiv(Z.getSpan(C("WIDTH"))+Z.getInput("AJSSW",null,null,"text",{readonly:""}),null,"AJSSInfo")+Z.getDiv(Z.getSpan(C("HEIGHT"))+Z.getInput("AJSSH",null,null,"text",{readonly:""}),null,"AJSSInfo")+Z.getDiv(Z.getSpan(C("ASPECT RATIO"))+Z.getInput("AJSSAR")+Z.getSpan(null,"AJSLockAR","AJSLock asicons-lock-open2"),null,"AJSSInfo"),"AJSWHAR","AJSEDivs")}function J(){var e=E?"<strong>"+w()+"</strong>":"",a=_?(e?" "+C("or")+" ":"")+"<strong>"+C("drop")+"</strong>":"",t=Z.getSpan(C("Choose file")+(B?"":" "+Z.getInput("AJSFileLegacy",null,null,"file")),"AJSChooseText","AJSBtnD")+Z.getSpan(null,"AJSCloseText","AJSBtnD asicons-cross")+(e||a?Z.getDiv(C("You can also")+" "+e+a+" "+C("the file"),"AJSUMore"):""),i=Z.getDiv(Z.getInput("AJSFile",null,P,"file")+Z.getDiv(t,"AJSChooseFile"),"AJSChooseSection");return Z.getDiv(i,"AJSUploadSection")+(_?Z.getDiv(Z.getHtml("a",C("DROP")),"AJSDropZone",P):"")}function w(){var e="(ctrl + v)";return navigator.platform.match(/Mac/i)&&(e="(cmd + v)"),C("paste")+" "+e}function C(e){return e}function y(e){return e.slice(-1)[0]}function x(e){if(e[0])return e[0];for(var a in e)if(e.hasOwnProperty(a))return e[a]}function I(e,a){for(var t=0;t<e.length;t++)if(e[t]===a)return!0;return!1}function H(e){return i.getElementById(e)}function b(e){return k("Object",e)}function R(e){return k("Array",e)}function k(e,a){if(void 0===a)return!1;var t=e.substr(0,1).toUpperCase()+e.substr(1).toLowerCase();return Object.prototype.toString.call(a)==="[object "+t+"]"}function D(e){return e.length>0}function L(e){var a=[];for(var t in e)e.hasOwnProperty(t)&&a.push(e[t]);return a}function F(e,a){var t;if(!e)return!1;try{t=JSON.parse(e)}catch(i){t=JSON.parse("'"+e+"'")}return t?a?L(t):t:!1}function W(e){var a=e;if(k("Array",a)){a={};for(var t=0,i=e.length;i>t;t++)e[t]&&(a[t]=e[t])}return JSON.stringify(a)}function Z(){function e(e,a){if(b(a))for(var t in a)if(a.hasOwnProperty(t)){var i=a[t];"boolean"==typeof i&&(i=i?1:0),e.setAttribute(t,i)}}var a=this;this.getLink=function(e,t,i,n,o,l){return b(l)||(l={}),o&&(l.rel="nofollow"),l.href=t,a.getHtml("a",e,i,n,l)},this.getHtml=function(a,t,n,o,l){var r=i.createElement(a);return t&&(r.innerHTML=t),n&&(r.id=n),o&&(r.className=o),e(r,l),r.outerHTML},this.getInput=function(e,t,i,n,o){return b(o)||(o={}),(t||0===t)&&(o.value=t),e&&!o.name&&(o.name=e),o.type=n?n:"text",a.getHtml("input",null,e,i,o)},this.getSpan=function(e,t,i,n){return a.getHtml("span",e,t,i,n)},this.getDiv=function(e,t,i,n){return a.getHtml("div",e,t,i,n)}}var P="AJSHidden",T=function(){},E="onpaste"in i,_="draggable"in i.createElement("span"),B=!!(a.Blob||a.File||a.FileList||a.FileReader),M=i.createElement("canvas"),U=!(!M.getContext||!M.getContext("2d")),j={VP_MAX_HEIGHT:420},O={accept:[".*"],allowFilters:!0,maxFileSize:2097152,maxFiles:1,iconPreviewHeight:200,iconPreviewWidth:200,maxHeight:1024,maxWidth:1024,onbeforeopen:T,onclose:T,onfilechanged:T,onfilechanging:T,onfileselected:T,onfilesloaded:T,onfilesloading:T,oninit:T,onlegacyuploadfail:T,onlegacyuploadfinish:T,onlegacyuploadstart:T,onopen:T,onsetuploaddata:T,onsingleuploadfail:T,onsingleuploadfinish:T,onsingleuploadstart:T,onuploadfail:T,onuploadfinish:T,onuploadprogress:T,onuploadstart:T,pathPrefix:"",quality:1,readonly:!1,scale9Grid:!0,showPreviewOnForm:!1,translateFunction:function(e){for(var a=1;a<arguments.length;a++){var t=new RegExp("\\{"+(a-1)+"\\}","g");e=e.replace(t,arguments[a])}return e},uploadScript:"/upload.php",uploadTo:"uploads"},G={init:function(o){function p(e){return K.s.translateFunction.apply(null,arguments)}function g(a,t,n,o){var l;if(I(["CANVAS","IMG"],a[0].tagName)&&!n)l='<span id="'+t+'"><span></span></span>';else if("SPAN"===a[0].tagName&&n)l=i.createElement(o?"canvas":"img"),l.id=t;else if("IMG"===a[0].tagName&&o)l=i.createElement("canvas"),l.id=t;else{if("CANVAS"!==a[0].tagName||o)return a;l=i.createElement("img"),l.id=t}return a.after(l),a.remove(),e("#"+t)}function v(e,a,t){a.newsrc&&(t=new Image,t.src=a.newsrc),t.width||t.height?f(e,a,t):t.onload=function(){f(e,a,t),q()}}function f(e,a,t){var i=l(t.width,t.height,K.s.maxWidth,K.s.maxHeight),n=e.getContext("2d");a.croppedWidth=a.resizedWidth=e.width=i.width,a.croppedHeight=a.resizedHeight=e.height=i.height,K.multipass(e,n,t),(a.newupload||K.edited)&&(a.newsrc=e.toDataURL(a.mimetype,K.s.quality))}function S(a,t,n,o,l,r){if(e("#AJSLoading").removeClass(P),r&&o.canvasZoom){var s=o.canvasZoom,d=i.createElement("canvas"),c=d.getContext("2d");d.width=o.croppedWidth,d.height=o.croppedHeight,c.drawImage(n,l.x,l.y,l.outwidth,l.outheight),a.width=o.canvasWidth,a.height=o.canvasHeight,t.drawImage(d,s.x,s.y,s.width,s.height)}else t.drawImage(n,l.x,l.y,l.outwidth,l.outheight);o.newsrc=a.toDataURL(o.mimetype,K.s.quality),e("#AJSLoading").addClass(P)}function A(e,a){switch(a){case"application/zip":case"application/gzip":return"asicons-file-zip";case"text/css":return"asicons-file-css";case"text/javascript":case"application/javascript":case"text/php":case"text/x-php":case"application/php":case"application/x-php":case"text/xml":case"text/html":return"asicons-code";case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":return"asicons-file-powerpoint";case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return"asicons-file-word";case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return"asicons-file-excel";case"application/pdf":case"application/x-pdf":case"application/vnd.pdf":return"asicons-file-pdf";case"application/vnd.oasis.opendocument.spreadsheet":case"application/vnd.oasis.opendocument.presentation":case"application/vnd.oasis.opendocument.text":return"asicons-file-openoffice"}switch(e){case"application":case"application-x":return"asicons-desktop";case"audio":return"asicons-microphone";case"model":return"asicons-tools";case"pdf":return"asicons-file-pdf";case"text":return"asicons-file-text-o";case"video":return"asicons-video";default:return"asicons-help"}}function J(e,a){var t=e.canvasWidth,i=e.canvasHeight,n=i?i:a.height,o=t?t:a.width,l=a.height,r=a.width,s=1;return n>j.VP_MAX_HEIGHT&&(s=n/j.VP_MAX_HEIGHT,n=j.VP_MAX_HEIGHT,o/=s,l/=s,r/=s),{height:n,thumbHeight:l,thumbWidth:r,width:o,scale:s}}function w(){var a=e(this),t=a[0].id.replace("AJSUploadBtn_","");K.event("beforeopen",this,{elemid:t.replace(/^\d+_(.*)$/,"$1"),index:t.replace(/^(\d+)_.*/,"$1"),uploads:K.uploads}),K=ZZ.streams[t],ZZ.currentstream=K;var i=e("#AJS");i.show(),i.css({marginTop:-(i.height()/2),marginLeft:-(i.width()/2)}),K.uploads.length?K.displayUpload():K.resetToUpload(),K.event("open",K,{original:K[0],uploads:K.uploads,length:K.uploads.length}),b(K.s.readonly),a.hasClass("AJSFPBtn")&&e("#AJSFile").click()}function C(){var a=e(this)[0].id,t=a.replace(/.*\_(\d+)$/,"$1");a=a.replace(/\_\d+$/,"");var i=a.replace("AJSFP_","");K.event("beforeopen",this,{elemid:i.replace(/^\d+_(.*)$/,"$1"),index:i.replace(/^(\d+)_.*/,"$1"),uploads:K.uploads}),K=ZZ.streams[i],ZZ.currentstream=K,K.currentupload=t;var n=e("#AJS");n.show(),n.css({marginTop:-(n.height()/2),marginLeft:-(n.width()/2)}),K.displayUpload(K.uploads[t]),e("#AJSMain > div").addClass(P),e("#AJSImagePreview").removeClass(P),K.event("open",K,{original:K[0],uploads:K.uploads,length:K.uploads.length}),b(K.s.readonly)}function b(a){var t=a?"addClass":"removeClass",i=K.uploads[K.currentupload];e("#AJSChange,#AJSRemove,#AJSEdit")[t](P),!a&&i&&(i.mimetype.match("image/*")&&"image/gif"!==i.mimetype&&U?e("#AJSEdit").removeClass(P):e("#AJSEdit").addClass(P))}function L(a){var t=j.VP_MAX_HEIGHT,i=a>t?t:a;e("#AJSRCVp").css({top:(t-i)/2})}function M(a){a.lastMove||e("#AJSCZ").streamBoundaries("reposition");var t=V(),i=K.uploads[K.currentupload],n=a.px||0===a.px?1*a.px:1,o=t.minWidth+t.width*n,l=t.minHeight+t.height*n,r=e("#AJSRCVp").streamBoundaries("updateOpts",{thumbHeight:l,thumbWidth:o}).streamBoundaries("reposition").positionData;i.edited=!0,i.canvasZoom={height:l*t.scale,width:o*t.scale,scalePercent:n,x:r.x*t.scale,y:r.y*t.scale}}function G(){var a=e("#AJSRCVp").streamBoundaries("getPositionData"),t=K.uploads[K.currentupload],i=V();t.canvasZoom||(t.canvasZoom={width:t.canvasWidth?t.canvasWidth:t.croppedWidth,height:t.canvasHeight?t.canvasHeight:t.croppedHeight,scalePercent:1}),t.canvasZoom.x=a.x*i.scale,t.canvasZoom.y=a.y*i.scale}function V(){var a,t,i=K.uploads[K.currentupload],n=i.croppedWidth,o=i.croppedHeight,r=i.canvasWidth?i.canvasWidth:n,s=i.canvasHeight?i.canvasHeight:o,d=n/o,c=1;if(n>o?(t=s,a=s*d,r>a&&(a=r,t=r/d)):(a=r,t=r/d,s>t&&(t=s,a=s*d)),s>j.VP_MAX_HEIGHT){var u=e("#AJSRITrack").streamBoundaries("getPositionData"),h=e("#AJSResImg"),p=h.is(":visible"),g=p?h.width():h.data("width"),m=p?h.height():h.data("height"),v=u.x2-u.x,f=u.y2-u.y,S=i.width,A=i.height;v*=S/g,f*=A/m;var w=l(v,f,K.s.maxWidth,K.s.maxHeight),C=J(i,w),y=t/j.VP_MAX_HEIGHT;t=j.VP_MAX_HEIGHT,a/=y,o=C.thumbHeight,n=C.thumbWidth,t>o&&(o=w.height,n=w.width),r>a&&(a=r/y,t=a/d),s>t&&(t=s/y,a=t*d),c=C.scale}return{width:n-a,height:o-t,minWidth:a,minHeight:t,scale:c}}function z(e){if(K.s.readonly&&(e=!1),_&&(e?(i.body.ondragover=N,i.body.ondrop=$):(i.body.ondragover=null,i.body.ondrop=null)),E){var a=H("AJS");a.onpaste=e?Y:null}}function N(a){var t=a.dataTransfer;(I(t.types,"Files")||I(t.types,"text/uri-list"))&&(e(a.target).closest(".AJSBtn,.AJSInlineDrop").parent().length?(e(".AJSInlineDrop").removeClass(P),e(".AJSBtn").addClass(P)):(e(".AJSInlineDrop").addClass(P),e(".AJSBtn").removeClass(P)),"AJSMainOverlay"===a.target.id?e("#AJSDropZone").addClass(P):(a.stopPropagation(),a.preventDefault(),t.dropEffect="copy",e("#AJSDropZone").removeClass(P)))}function $(a){a.stopPropagation(),a.preventDefault(),e(".AJSInlineDrop").css({display:"none"});var t=e(a.target);if(t.closest("#AJS,.AJSInlineDrop").length){if(e("#AJSLoading").removeClass(P),t.closest(".AJSInlineDrop").length){var i=t.parent().find(".AJSBtn");i.click().removeClass(P)}for(var n=a.dataTransfer,o=n.files,l=0;l<o.length;l++)o[l].type.match(K.s.accept)||(o[l]=null);if(!o.length&&U){var r=K.uploads.length+1;if(r>K.s.maxFiles)return streamConfirm(p("Maximum files exceeded"),{Close:T},p("You have selected {0} files but are only permitted to upload {1}",r,K.s.maxFiles),{nocancel:!0}),e("#AJSDropZone").addClass(P),void e("#AJSLoading").addClass(P);z();var s=n.getData("url");return s||(s=n.getData("text/plain"),s||(s=n.getData("text/uri-list")))?(K.event("filesloading",null,{original:K[0],toload:K.toload,loaded:K.loaded,uploads:K.uploads,stream:K}),X(s,p("There was an error processing the external file you dropped")),void e("#AJSDropZone").addClass(P)):void e("#AJSLoading").addClass(P)}e("#AJSDropZone").addClass(P),K.addingmore=!0,K.filechanged.call(null,{eventType:"drop",originalEvent:a,target:{files:o}})}}function X(a,t){var i=function(){z(!0)};e.ajax({url:K.s.uploadScript+"?external=true",type:"post",dataType:"json",data:{filesrc:a,uploaddir:K.s.uploadTo}}).done(function(a){if("OK"===a.result){i();var n=K.uploads.length;if(a.data.index=n,K.uploads[n]=a.data,K.currentlength++,e("#AJSFile,#AJSFileLegacy").val(null),e("#AJSUploadSection").addClass(P),e("#AJSImagePreview").removeClass(P),K.toggleLR(),K.event("filesloaded",null,{loaded:K.loaded,original:K[0],uploads:K.uploads,stream:K}),K.changing=!1,K.toload=K.loaded=0,a.data.mimetype.match("image/*")){var o=new Image;o.onload=function(){this.imageloaded=!0,ZZ.images["AJSIMG_"+K.id+n]=o,K.displayUpload(null,!0)},o.onerror=function(){K.uploads.splice(n,1),t&&streamConfirm(p("Error"),{Close:i},t,{nocancel:!0})},o.src=a.data.src+"?cachekill="+(new Date).getTime()}else K.displayUpload(null,!0)}else t&&streamConfirm(p("Error"),{Close:i},t,{nocancel:!0})}).fail(function(){e("#AJSLoading").addClass(P),t&&streamConfirm(p("Error"),{Close:i},t,{nocancel:!0})})}function Y(a){for(var t=a.clipboardData.items,i=t.length,n=null,o=!1,l=0;l<t.length;l++){var r=t[l];r.type.match(K.s.accept)||(r.type.match(/^text\/html/)&&"getAsString"in r&&r.getAsString(function(a){n=e(a)[1].src,o&&n&&n.match(/^http(:?s)?\:\/\//)&&X(n)}),t[l]=null,i--)}if(!i)return void(o=!0);K.toload=i,K.loaded=0;var s=i+K.uploads.length;s>K.s.maxFiles&&(streamConfirm(p("Maximum files exceeded"),{Close:T},p("You have selected {0} files but are only permitted to upload {1}",s,K.s.maxFiles),{nocancel:!0}),i=K.toload=K.s.maxFiles-K.uploads.length);for(var l=0;i>l;l++){var r=t[l];if(r){var d=r.getAsFile();d&&d.size?(K.addingmore=!0,K.process(d,l)):(o=!0,o&&n&&n.match(/^http(:?s)?\:\/\//)?(o=!1,X(n,p("There was an error processing the file that you pasted"))):streamConfirm(p("Error"),{Close:T},p("There was an error processing the pasted file. The system will try to get the file another way"),{nocancel:!0}))}}}function q(){var a="AJSIMG_"+K.id+K.currentupload,t=e("#"+a);t.is(":visible")&&t.css({top:(500-t.height())/2});var i=e("#AJS");i.css({marginLeft:-(i.width()/2),marginTop:-(i.height()/2)})}function Q(){var e="",a=K.uploads,t=parseFloat(K.s.iconPreviewHeight),i=parseFloat(K.s.iconPreviewWidth),n=0;for(var o in a){var l,r=a[o],s=r.mimetype.replace(/\/.*$/,""),d="image"===s;if(d){var c,u=r.canvasWidth?r.canvasWidth:r.croppedWidth,h=r.canvasHeight?r.canvasHeight:r.croppedHeight;if(h>u)c="height: 100%;width: auto;";else{var g=u/h,h=i/g;c="width: 100%;height: auto;margin-top:"+(t-h)/2+"px;"}l=Z.getHtml("img",null,null,null,{src:r.newsrc,style:c})}else l=Z.getSpan(null,null,A(s,r.mimetype),{style:"line-height:"+t+"px;font-size:"+(i-20)+"px;"});l+=Z.getDiv(r.name,null,"AJSFPName"),e+=Z.getDiv(l,"AJSFP_"+K.id+"_"+r.index,"AJSFP",{style:"width:"+i+"px;height:"+t+"px;",tabindex:0}),n++}return K.s.maxFiles&&a.length+1<=K.s.maxFiles&&K.uploads.length&&B&&(e+=Z.getSpan(null,"AJSUploadBtn_"+K.id,"asicons-plus AJSBtn AJSFPBtn",{"data-ajaxstreamid":K.c,tabindex:0})),n||(e+=Z.getSpan(p("Upload"),"AJSUploadBtn_"+K.id,"AJSBtn",{"data-mandatory":!0,"data-ajaxstreamid":K.c,tabindex:0})+Z.getSpan(p("Drop"),"AJSDropZone_"+K.id,"AJSInlineDrop "+P)),e}var K=this;if(K.length>1)return K.each(function(){e(this).ajaxStream(o)}),K;if(!K.length||K.c)return K;var ea=e("body");return K.c=++t,K.currentupload=null,K.currentlength=0,K.changing=!1,K.toload=0,K.loaded=0,K.uploads=[],K.addingmore=!1,K.s=e.extend(e.extend({},O),o),K.id=[K.c,"_",K.prop("id")].join(""),K.filedata={},K.event=function(e,a){return K.s["on"+e].apply(a,Array.prototype.slice.call(arguments,2))},K.legacyUpload=function(t){var i=K.changing===!1?K.uploads.length:K.changing;K.filedata={aspectRatioLocked:!1,base64:null,canvasWidth:null,canvasHeight:null,canvasZoom:null,croppedWidth:null,croppedHeight:null,index:i,islegacy:!0,mimetype:null,name:null,newupload:!0,resizedWidth:null,resizedHeight:null,size:null},a.AJSLegacy=ZZ.streams[K.id],e("#AJSLegacy").val(JSON.stringify({maxsize:K.s.maxFileSize,maxheight:K.s.maxHeight,maxwidth:K.s.maxWidth,uploaddir:K.s.uploadTo,islegacy:!0,id:K.id}));var n=e("#AJSFileLegacy"),o=n.clone();o.insertAfter(n),n[0].id=null,e("#AJSLegacyForm").prop({action:K.s.uploadScript+"?newupload=true"}).append(n),o.unbind("change",K.filechanged).change(K.filechanged),K.event("legacyuploadstart",t,{original:K[0],stream:K,uploads:K.uploads}),H("AJSLegacyForm").submit(),e("#AJSLoading").removeClass(P)},K.afterLegacyUpload=function(t){e("input[name=AJSFileLegacy]","#AJSLegacyForm").remove(),e("#AJSLoading").addClass(P),t.moved?(t.mimetype.match("image/*")&&(K.filedata.croppedWidth=K.filedata.resizedWidth=K.filedata.width=t.width,K.filedata.croppedHeight=K.filedata.resizedHeight=K.filedata.height=t.height),K.currentlength++,K.filedata.newsrc=t.location,K.filedata.src=t.location,K.filedata.name=t.name,K.filedata.size=t.size,K.filedata.mimetype=t.mimetype,K.filedata.src=t.location,K.event("legacyuploadfinish",K,{original:K[0],results:t,uploads:K.uploads}),K.afterFileRead(K.filedata,K.changing!==!1),a.AJSLegacy=null):(K.event("legacyuploadfail",null,{original:K[0],error:t.error,results:t,uploads:K.uploads,stream:K}),streamConfirm(p("Error"),{Close:T},t.error,{nocancel:!0}))},K.filechanged=function(e){var a=e.target.files;if(!a&&e.target.value.match(/^.\:\\/))return K.legacyUpload(this),void(K.toload=1);if(!a.length)return void(K.changing=!1);var t=K.toload=a.length;if(K.event("fileselected",this,{originalEvent:e.originalEvent,files:a,toload:K.toload,original:K[0],stream:K,jQueryEvent:e,uploads:K.uploads}),B){for(var i=0;t>i;i++)a[i]||K.toload--;if(K.toload<=0&&streamConfirm(p("Error"),{Close:T},p("There was an error during the upload: the file list is empty"),{nocancel:!0}),K.changing===!1){t=K.toload;var n=t+K.uploads.length;n>K.s.maxFiles&&(streamConfirm(p("Maximum files exceeded"),{Close:T},p("You have selected {0} files but are only permitted to upload {1}",n,K.s.maxFiles),{nocancel:!0}),t=K.toload=K.s.maxFiles-K.uploads.length);for(var i=0;t>i;i++)a[i]&&K.process(a[i],i)}else K.event("filechanging",this,{originalEvent:e.originalEvent,file:a[0],current:K.uploads[K.changing],original:K[0],jQueryEvent:e,stream:K,uploads:K.uploads}),K.process(a[0],K.changing,!0,this)}else K.legacyUpload(this)},K.process=function(t,n,o,r){if(e("#AJSLoading").removeClass(P),k("blob",t)||k("file",t)){var s=new FileReader,d=t.type.match("image/*")&&"image/gif"!==t.type;s.onload=function(e){var s=new Blob([e.target.result],{type:t.type}),c=(a.URL||a.webkitURL).createObjectURL(s),u=o?n:null,h={aspectRatioLocked:!1,edited:!1,index:u,islegacy:!1,mimetype:t.type,name:t.name,newupload:!0,size:t.size,src:c};if(o||K.currentlength++,d){var p=new Image,g=i.createElement("canvas"),m=g.getContext("2d");p.onload=function(){var e=this,a=l(p.width,p.height,K.s.maxWidth,K.s.maxHeight);e.imageloaded=!0,g.width=h.width=h.resizedWidth=h.croppedWidth=a.width,g.height=h.height=h.resizedHeight=h.croppedHeight=a.height,h.canvasWidth=h.canvasHeight=h.canvasZoom=null,h.cropdata={},h.image=e,K.multipass(g,m,p),h.newsrc=g.toDataURL(h.mimetype,1),K.afterFileRead(h,o,r)},p.onerror=function(){h.src=null,K.afterFileRead(h,o,r)},p.src=c}else h.newsrc=e.target.result,K.afterFileRead(h,o,r)},s.onerror=function(a){var t=a.currentTarget.error;e("#AJSLoading").addClass(P),streamConfirm(p("Error"),{Close:T},p("There was an error processing the selected file.\n                        Make sure what you selected was indeed a file. Full details")+": "+t.message,{nocancel:!0}),console.error(t.name+": "+t.message)},d?s.readAsArrayBuffer(t):s.readAsDataURL(t)}else streamConfirm(p("Error"),{Close:T},p("The selection is not a file"),{nocancel:!0})},K.afterFileRead=function(e,a,t){var i,n=null;a?(i=e.index,n=K.uploads[i],K.uploads[i]=e):(i=K.uploads.length,e.index=i,K.uploads[i]=e),ZZ.images["AJSIMG_"+K.id+i]=e.image,delete e.image,K.attemptProgression(t,e.index,n)},K.attemptProgression=function(a,t,i){if(K.loaded++,K.event("filesloading",a,{original:K[0],toload:K.toload,loaded:K.loaded,uploads:K.uploads,stream:K}),K.loaded===K.toload){e("#AJSFile,#AJSFileLegacy").val(null),e("#AJSLoading").addClass(P),e("#AJSUploadSection").addClass(P),e("#AJSImagePreview").removeClass(P),K.toggleLR();var n=K.changing===!1;K.changing===!1&&K.event("filechanged",a,{original:K[0],newfile:K.uploads[t],oldfile:i,uploads:K.uploads,stream:K}),K.event("filesloaded",a,{loaded:K.loaded,original:K[0],uploads:K.uploads,stream:K}),K.changing=!1,K.toload=K.loaded=0,K.displayUpload(null,n)}},K.toggleLR=function(){K.uploads.length>1?e("#AJSLRContainer").removeClass(P):e("#AJSLRContainer").addClass(P)},K.displayUpload=function(a,t){if(K.uploads.length){a||(a=K.getCurr(t)),e("#AJSAdd")[K.currentlength+1>K.s.maxFiles?"addClass":"removeClass"](P);var i=a.mimetype.match("image/*"),n=i?"image/gif"===a.mimetype?a.newsrc:a.src:null;K.toggleLR(),n||!i&&!n?(K.drawImage(a,n),K.currentupload=a.index):streamConfirm(p("Corrupt upload"),{ok:K.deleteUpload},p("There is no source for this upload meaning that you cannot continue. Click 'ok' to delete"),{nocancel:!0})}else K.resetToUpload()},K.drawImage=function(a,t){var i="AJSIMG_"+K.id+a.index,n=a.mimetype.replace(/\/.*$/,""),o="image"===n,l=B&&U&&o&&"image/gif"!==a.mimetype,r=e("#"+i),s=e("#AJSEdit");if(s.addClass(P),r.length)r=g(r,i,o,l);else{var d="";d=l?'<canvas id="'+i+'"></canvas>':a.mimetype.match("image/*")?'<img id="'+i+'"/>':'<span id="'+i+'"><span></span></span>',e("#AJSLRContainer").before(d),r=e("#"+i)}l?(s.removeClass(P),v(r[0],a,ZZ.images[i])):"image"===n?(r[0].src=t,a.width&&a.height||(r[0].onload=function(){a.width=this.width,a.height=this.height,a.canvasWidth=a.canvasHeight=null})):(r.attr({"class":"AJSMIMEIcons "+A(n,a.mimetype)}),r.find("span").html(a.name)),e('[id^="AJSIMG_"]').addClass(P);var c="CANVAS"===r[0].tagName?r[0].height:r.height();c||(c=a.croppedHeight),r.removeClass(P).css({top:c>500?0:(500-c)/2}),e("#AJSLoading").addClass(P),q()},K.setCropped64=function(a,t,i,n,o){if(U){var r=a.getContext("2d"),s=e("#AJSResImg"),d=s.is(":visible"),c=d?s.width():s.data("width"),u=d?s.height():s.data("height"),h=n.x2-n.x,p=n.y2-n.y,g=t.width,m=t.height;h*=g/c,p*=m/u;var v=l(h,p,K.s.maxWidth,K.s.maxHeight),f=v.width,A=v.height,J=f/h,w=A/p,C=-n.x*(g/c)*J,y=-n.y*(m/u)*w,x=g*J,I=m*w;t.croppedWidth=a.width=f,t.croppedHeight=a.height=A,i.imageloaded?S(a,r,i,t,{x:C,y:y,outwidth:x,outheight:I},o):(e("#AJSLoading").removeClass(P),i.onload=function(){i.imageloaded=!0,S(a,r,i,t,{x:C,y:y,outwidth:x,outheight:I},o),e("#AJSLoading").addClass(P)})}},K.multipass=function(e,a,t,o,l,r,s){var d=r?r:e.width,c=s?s:e.height,u=void 0===o?0:n.floor(o),h=void 0===l?0:n.floor(l);if(t.width/d>2||t.height/d>2){var p=i.createElement("canvas"),g=p.getContext("2d");p.width=.5*t.width,p.height=.5*t.height,g.drawImage(t,u,h,p.width,p.height),g.drawImage(p,0,0,.5*p.width,.5*p.height),a.drawImage(p,0,0,.5*p.width,.5*p.height,.75*u,.75*h,d,c)}else a.drawImage(t,u,h,d,c)},K.resetToUpload=function(){var a=e("#AJSRContainer");e("#AJSUploadSection").removeClass(P),e("#AJSImagePreview").addClass(P),e("#AJSChooseText").removeClass(P),e("#AJSLoading").addClass(P),K.uploads.length?a.removeClass(P):a.addClass(P)},K.getCurr=function(e){if(e)return K.currentupload=K.uploads.length-1,K.uploads[K.currentupload];if(K.addingmore){var a=y(K.uploads);return K.currentupload=a.index,a}return K.currentupload||0===K.currentupload?K.uploads[K.currentupload]:(K.currentupload=0,x(K.uploads))},K.changePrev=function(e){var a,t=e?-1:1;K.currentupload+t<0?(a=y(K.uploads),K.currentupload=K.uploads.length-1):K.currentupload+t>K.uploads.length-1?(a=x(K.uploads),K.currentupload=0):(a=K.uploads[K.currentupload+t],K.currentupload+=t),K.displayUpload(a)},K.iconClick=function(){K=ZZ.currentstream;var a=e(this),t=e(".EIconActive");if(t.data("for")===a.data("for"))return!1;e("#AJSLoading").removeClass(P);var n=e("#AJSRInner"),o=e("#AJSRC");switch(e(".AJSEDivs").addClass(P),e("#"+a.data("for")).removeClass(P),a.data("for")){case"AJSRCan":var r=e("#AJSRITrack").streamBoundaries("getPositionData"),s=K.uploads[K.currentupload],d=s.canvasZoom,c=d?d.scalePercent:!1,u=s.canvasWidth,h=s.canvasHeight,p=e("#AJSResImg"),g=p.width(),m=p.height(),v=u&&h&&null===d,f=r.x2-r.x,S=r.y2-r.y,A=s.width,w=s.height;f*=A/g,S*=w/m;var C=l(f,S,K.s.maxWidth,K.s.maxHeight),y=J(s,C);if(p.attr({"data-width":g,"data-height":m}),K.setCropped64(i.createElement("canvas"),s,ZZ.images["AJSIMG_"+K.id+K.currentupload],r),n.addClass(P),o.removeClass(P),H("AJSRCImg").src=s.newsrc,H("AJSCW").value=u?u:s.croppedWidth,H("AJSCH").value=h?h:s.croppedHeight,e("#AJSRCVp").streamBoundaries("updateOpts",{height:y.height,thumbHeight:y.thumbHeight,thumbWidth:y.thumbWidth,width:y.width}),c||0===c||v){c=v?1:c;var x=e("#AJSCZ").streamBoundaries("reposition",{x:100*c+"%"});M.call(x,x.positionData)}L(h?h:C.height);break;case"AJSWHAR":o.addClass(P),n.removeClass(P)}t.removeClass("EIconActive"),a.addClass("EIconActive"),e("#AJSLoading").addClass(P)},K.fillEditValues=function(e,a){if(a){var t=K.getScaledDimensions(a,e);H("AJSSAR").value=u(t.aspectRatio),H("AJSSW").value=t.width,H("AJSSH").value=t.height}},K.getScaledDimensions=function(e,a){var t=e.rect,i=t.width,n=t.height,o=r((e.x2-e.x)*(a.width/i)),s=r((e.y2-e.y)*(a.height/n)),d=K.s.maxWidth,c=K.s.maxHeight,u=l(o,s,d,c);return o=u.width,s=u.height,{width:o,height:s,aspectRatio:o/s}},K.showInfo=function(){e(".AJSEIcon:first").click(),e("#AJSLoading").removeClass(P);var t=K.uploads[K.currentupload],n=t.cropdata,o=e("#AJSResImg"),l=e("#AJSRInner"),r=e("#AJSRITrack"),d=ZZ.images["AJSIMG_"+K.id+K.currentupload],c=Z.getHtml("img",null,"AJSResImg",null,{src:d.src,"data-top":o.attr("data-top"),"data-bottom":o.attr("data-bottom"),"data-width":o.attr("data-width"),"data-height":o.attr("data-height"),style:o.attr("style")}),u=e("#AJSLockAR");e("#AJSMain > div").addClass(P),e("#AJSMore").removeClass(P),o.remove(),l.prepend(c),o=e("#AJSResImg"),l.hide(),o[0].onload=function(){e("#AJSLoading").addClass(P),l.show(),o.css({maxWidth:parseFloat(e(a).width())-20}),l.css({width:"auto"});var d=o[0].getBoundingClientRect(),c=d.width,h=d.height,p=void 0!==n.x?n.x2-n.x:c,g=void 0!==n.y?n.y2-n.y:h;r.streamBoundaries("updateOpts",{width:c,height:h,thumbWidth:p,thumbHeight:g,onFinish:function(e){e.rect=d,K.fillEditValues(t,e),s(e),K.uploads[K.currentupload].canvasZoom=null}}),l.width(c);var m=r.streamBoundaries("reposition",{x:n.x||0===n.x?n.x:0,y:n.y||0===n.y?n.y:0}).positionData;s(m),m.rect=d,K.fillEditValues(t,m),t.aspectRatioLocked?u.removeClass("asicons-lock-open2").addClass("asicons-lock2"):u.removeClass("asicons-lock2").addClass("asicons-lock-open2"),e(".AJSEIcon").removeClass("EIconActive").first().click();var v=e("#AJS"),f=(parseFloat(l.height())-h)/2;e("#AJSRBG").css({top:-h,height:h}),v.css({minWidth:c>340?c:340,marginLeft:-(v.width()/2)}),o.css({marginTop:f}).attr({"data-top":f,"data-bottom":f+h}),r.css({marginTop:f}),q(),_&&(i.body.ondragover=null,i.body.ondrop=null),z()},o[0].src=d.src},K.saveInfo=function(){var a=K.uploads[K.currentupload],t=e("#AJSRITrack").streamBoundaries("getPositionData"),i="AJSIMG_"+K.id+K.currentupload,n=e("#"+i);if(!ZZ.images[i]){var o=new Image;o.onload=function(){this.imageloaded=!0},o.src=a.src+"?cachekill="+(new Date).getTime(),ZZ.images[i]=o}K.setCropped64(H(i),a,ZZ.images[i],t,!0);var l={x:t.x,x2:t.x2,y:t.y,y2:t.y2};a.cropdata!==l&&(a.edited=!0,K.edited=!0),a.cropdata=l,e("#AJSMain > div").addClass(P),e("#AJSImagePreview").removeClass(P),e("#AJS").css({minWidth:"initial"}),n.css({top:(500-n.height())/2}),q(),z(!0),e.streamBoundaries.unsetMouseMove()},K.deleteUpload=function(){for(var a=[],t=!1,i=!1,n=0,o=K.uploads.length;o>n;n++)if(K.uploads[n]&&n!==K.currentupload){var l=K.uploads[n];l.index=a.length,a.push(l),i!==!1&&t!==!1&&(i=n)}else t=n;e("#AJSIMG_"+K.id+K.currentupload).remove(),K.uploads=a,K.currentlength=K.uploads.length,K.currentupload=i!==!1?i:0,e("#AJS_"+K[0].id).val(W(K.uploads)),e("#AJSUploadSection").addClass(P),e("#AJSImagePreview").removeClass(P),K.toggleLR(),K.displayUpload()},K.initBinding=function(){var t=e(B?"#AJSFile":"#AJSFileLegacy");t.unbind("click").click(function(){var a=K.s.accept;(".*"===a||R(a)&&I(a,".*"))&&(a="*");var t={accept:a};K.s.maxFiles>1&&(t.multiple=!0),e(this).attr(t)}),B&&e("#AJSChooseText").unbind("click").click(function(){K.addingmore=!0,K.changing=!1,t.click()}),z(!0),t.unbind("change").change(K.filechanged),e("#AJSImagePreview").unbind("dbclick").dblclick(function(){a.getSelection?a.getSelection().removeAllRanges():i.selection&&i.selection.empty()}),e("#AJSAdd").unbind("click").click(function(){K.uploads.length+1<=K.s.maxFiles&&(t.click(),K.addingmore=!0)}),e("#AJSChange").unbind("click").click(function(){K.changing=K.currentupload,K.addingmore=!1,t.click()}),e("#AJSL").unbind("click").click(function(){K.changePrev(!0)}),e("#AJSR").unbind("click").click(function(){K.changePrev()});var n=H("AJSICancel"),o=H("AJSISave"),d=H("AJSCW"),c=H("AJSCH"),u=H("AJSSAR"),h=H("AJSEdit");h&&(h.onclick=K.showInfo),n&&(n.onclick=function(){e("#AJSMain > div").addClass(P),e("#AJSImagePreview").removeClass(P);var a=e("#AJSIMG_"+K.id+K.currentupload);e("#AJS").css({minWidth:"initial"}),a.css({top:(500-a.height())/2}),q(),z()}),o&&(o.onclick=K.saveInfo),e("#AJSRemove").unbind("click").click(function(){streamConfirm(p("Are you sure you want to remove this file?"),K.deleteUpload,p("This removes the file from the list of files to be uploaded, and not from your computer"))}),e("#AJSClose,#AJSCloseText").unbind("click").click(function(){K.s.readonly||e("#AJS_"+K[0].id).val(W(K.uploads)),e("#AJS").hide(),K.s.showPreviewOnForm&&(e("#AJSFormPrev_"+K.id).html(Q()),e("[id^=AJSUploadBtn_]").unbind("click",w).click(w),e(".AJSFP").unbind("click",C).click(C)),K.event("close",K,{original:K[0],uploads:K.uploads,length:K.uploads.length})
}),e("[id^=AJSUploadBtn_]").unbind("click",w).click(w),e(".AJSFP").unbind("click",C).click(C),u&&(u.onchange=function(){e("#AJSLockAR").removeClass("asicons-lock-open2").addClass("asicons-lock2");var a,t=this.value,i=e("#AJSRITrack").streamBoundaries("getPositionData"),n=K.uploads[K.currentupload];if(n.aspectRatioLocked=!0,t&&t.match(/^(:?\s+)?\d+(:?\.\d+)?(:?\/|\:)\d+(:?\.\d+)?$/)){var o=t.split(/[\/|\:]/);a=o[0]/o[1]}else{if(!t||!t.match(/^(:?\s+)?(:?\d+|\d+\.\d+)$/))return;a=1*t}var l=H("AJSResImg").getBoundingClientRect(),d=n.width/l.width,c=n.height/l.height,u=i.x2-i.x,h=r(u/a),p=!1,g=!1;h+i.y>l.height&&(g=l.height-h,h>l.height&&(h=l.height,u=r(h*a),g=0,u+i.x>l.width&&(p=l.width-u)));var m=e("#AJSRITrack").streamBoundaries("updateOpts",{thumbWidth:u,thumbHeight:h,x:p,y:g}).positionData;H("AJSSW").value=r(u*d),H("AJSSH").value=r(h*c),s(m)}),d&&(d.onchange=function(){var a=1*this.value,t=a>K.maxWidth?K.maxWidth:a,i=H("AJSCH"),n=1*i.value,o=K.uploads[K.currentupload],r=l(t,n,K.s.maxWidth,K.s.maxHeight,o);this.value=o.canvasWidth=r.width,i.value=o.canvasHeight=r.height;var s=J(o,r),d=e("#AJSCZ").streamBoundaries();e("#AJSRCVp").streamBoundaries("updateOpts",{height:s.height,thumbHeight:s.thumbHeight,thumbWidth:s.thumbWidth,width:s.width}),L(r.height),e("#AJSRCVp").streamBoundaries("reposition"),M.call(d,d.positionData)}),c&&(c.onchange=function(){var a=1*this.value,t=a>K.s.maxHeight?K.s.maxHeight:a,i=H("AJSCW"),n=1*i.value,o=K.uploads[K.currentupload],r=l(n,t,K.s.maxWidth,K.s.maxHeight,o);this.value=o.canvasHeight=r.height,i.value=o.canvasWidth=r.width;var s=J(o,r),d=e("#AJSCZ").streamBoundaries();e("#AJSRCVp").streamBoundaries("updateOpts",{height:s.height,thumbHeight:s.thumbHeight,thumbWidth:s.thumbWidth,width:s.width}),L(r.height),e("#AJSRCVp").streamBoundaries("reposition"),M.call(d,d.positionData)}),e("#AJSLockAR").click(function(){var a=e(this),t=a.hasClass("asicons-lock-open2");t?a.removeClass("asicons-lock-open2").addClass("asicons-lock2"):a.removeClass("asicons-lock2").addClass("asicons-lock-open2"),K.uploads[K.currentupload].aspectRatioLocked=t}),e(".AJSEIcon").unbind("click",K.iconClick).click(K.iconClick),e(window).unbind("resize",q).resize(q)},K.redraw=function(){e("#AJSFormPrev_"+K.id).html(Q()),e("[id^=AJSUploadBtn_]").unbind("click",w).click(w),e(".AJSFP").unbind("click",C).click(C)},K.draw=function(){K.addClass(P),K.attr({"data-ajaxstreamid":K.c});var a=!1;if(D(e("#AJS_"+K[0].id))){var t=e("#AJS_"+K[0].id).val();K.uploads=t.length?F(t,!0):[],K.currentlength=K.uploads.length;for(var i=0;i<K.currentlength;i++){var n=K.uploads[i];if(n.cropdata||(n.cropdata={}),!n.src){var o=d(n.newsrc,n.mimetype);o?n.src=URL.createObjectURL(o):(K.uploads.splice(i,1),console.warn("Removed file: "+n.name),a||(streamConfirm(p("There are bad files")),a=!0))}if(n.mimetype){if(n.mimetype.match("image/*")){var l=new Image;l.onload=function(){this.imageloaded=!0},l.ajsindex=i,l.ajsname=n.name,l.onerror=function(){K.uploads=K.uploads.splice(this.ajsindex,1),console.warn("Removed file: "+this.ajsname),a||(streamConfirm(p("There are bad files")),a=!0),e("#ajaxstream_"+K[0].id).val(JSON.stringify(K.uploads)),e("#AJSFP_"+K.id+"_"+this.ajsindex).remove(),K.currentlength=K.uploads.length,delete ZZ.images["AJSIMG_"+K.id+this.ajsindex]},l.src=n.src.match(/^http(:?s)?\:/)?n.src+"?cachekill="+(new Date).getTime():n.src,ZZ.images["AJSIMG_"+K.id+i]=l}}else n.mimetype="application/octet-stream"}}else K.after(Z.getInput("AJS_"+K[0].id,null,null,"hidden"));K.after(K.s.showPreviewOnForm?Z.getDiv(Q(),"AJSFormPrev_"+K.id,"AJSFormPrev",{style:"height:"+K.s.iconPreviewHeight}):Z.getSpan(p("Upload"),"AJSUploadBtn_"+K.id,"AJSBtn",{"data-mandatory":!0,"data-ajaxstreamid":K.c})),D(e("#AJS"))||(ea.append(Z.getDiv(h(K.s.pathPrefix),"AJS")),B?e("#AJSImagePreview").after(m()):c(),e("#AJSRITrack").streamBoundaries({width:"100%",height:"100%",orientation:"2d",resizable:!0,bg:"none",thumbBg:"none",round:!1,scale9Grid:K.s.scale9Grid,onBeforeUpdate:function(){K=ZZ.currentstream,this.s.lockAspectRatio=K.uploads[K.currentupload].aspectRatioLocked},onUpdate:function(e){s(e)}}),e("#AJSRCVp").streamBoundaries({crosshair:!1,height:"100%",isViewport:!0,orientation:"2d",onFinish:G,thumbBorder:"none",width:"100%"}),e("#AJSCZ").streamBoundaries({bg:"#999",crosshair:!1,height:8,onFinish:M,onUpdate:M,thumbBg:"#444",thumbBorder:"none",thumbBorderRadius:3,thumbHeight:8,thumbWidth:"15%",trackBorderRadius:3,width:"100%",x:"85%"})),K.initBinding(),K.event("init",K,{original:K[0],uploads:K.uploads})}(),ZZ.streams[K.id]=K,K},setUploadData:function(a,t){var i=this,n=!1;k("string",a)&&(a=F(a)),i.uploads=a?L(a):[];for(var o=0;o<i.uploads.length;o++)if(i.uploads[o].mimetype.match("image/*")){var l=new Image,r=i.uploads[o],s=r.src;l.onload=function(){this.imageloaded=!0},l.ajsindex=o,l.ajsname=r.name,l.onerror=function(){i.uploads=i.uploads.splice(this.ajsindex,1),console.warn("Removed file: "+this.ajsname),n||(streamConfirm(C("There are bad files")),n=!0),e("#AJS_"+i[0].id).val(JSON.stringify(i.uploads)),e("#AJSFP_"+i.id+"_"+this.ajsindex).remove(),i.currentlength=i.uploads.length,delete ZZ.images["AJSIMG_"+i.id+this.ajsindex]},l.src=s.match(/^http(:?s)?\:/)?s+"?cachekill="+(new Date).getTime():s,ZZ.images["AJSIMG_"+i.id+o]=l}i.currentlength=i.uploads.length,i.toload=i.loaded=i.currentupload=0,t&&i.redraw(),i.event("setuploaddata",i,{original:i[0],uploads:i.uploads})}};e.fn.ajaxStream=function(a){var t=o(this);return G[a]?G[a].apply(t,Array.prototype.slice.call(arguments,1)):"[object Object]"!==Object.prototype.toString.call(a)&&a?void e.error(["The method ",a," does not exist"].join("")):G.init.apply(t,arguments)},window.ZZ=e.ajaxStream={author:"Luke Madhanga",currentstream:null,images:{},license:"MIT",streams:{},setDefaults:function(a){O=e.extend(O,a)},version:"2.0.13"},Z=new Z}(jQuery,this,0,document,Math);